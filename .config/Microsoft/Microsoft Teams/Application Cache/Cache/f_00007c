webpackJsonp([33],{2709:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),a(2710)},2710:function(t,e,a){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0});var i,o=a(2711),s=a(2712),r=a(7),c=a(2713),l=teamspace.components.TelemetryHelper,d=teamspace.services.CortanaServiceEvents,p=teamspace.services.CortanaState,u=teamspace.services.KwsResult,h="CortanaController";!function(t){t.Phrase="phrase",t.AdaptiveCard="adaptiveCard",t.DisplayText="displayText",t.ErrorMessage="errorMessage"}(i||(i={}));var g=(n={},n[p.Ready]="[[staticsPath]]/hashed/cortana/sprite_idle-8eaf798.svg",n[p.Listening]="[[staticsPath]]/hashed/cortana/sprite_listening-a319b9b.svg",n[p.Thinking]="[[staticsPath]]/hashed/cortana/sprite_thinking-26996c2.svg",n[p.Speaking]="[[staticsPath]]/hashed/cortana/sprite_responding-aecffdb.svg",n),v=function(){function t(t,e,a,n,i,o,s,r,c,l,d,u,v,m,S,f,C,b,y,w,k,E,A){this.$rootScope=t,this.$interval=e,this.$scope=a,this.$timeout=n,this.$translate=i,this.analyticsService=o,this.brbV2FeedbackService=s,this.callingService=r,this.constants=c,this.cortanaConfigurationService=l,this.cortanaEventingService=d,this.cortanaLoaderService=u,this.eventingService=v,this.loggingService=m,this.resources=S,this.shortcutService=f,this.platformDetectService=C,this.settingsService=b,this.tooltipService=y,this.cortanaFREService=w,this.utilityService=k,this.ariaLiveService=E,this.dialogService=A,this.cortanaTooltipId="cortana",this.helpPageUrl="https://go.microsoft.com/fwlink/?linkid=2110301",this.cortanaState=p.Ready,this.cortanaIcon=g[p.Ready],this.educationalPageNumber=0,this.helpOptions=[],this.hostConfigDefault={lineHeights:{small:24,medium:24,default:24,large:24,extraLarge:24},imageSizes:{small:56,medium:56,large:56},spacing:{padding:0},fontTypes:{default:{fontSizes:{small:18,medium:18,default:18,large:18,extraLarge:18}}}},this.showRetryButton=!0,this.showDefaultState=!0,this.previousSkillExecuted=!1,this.cortanaKeyboard=null,this.pendingEducationalAction=!1,this.cortanaInvocationLatencyScenarioName="cortana_invocation",this.showFullCortanaDialog=!0,this.logger=m.newLogger(h),this.enableAdaptiveCard=b.valueAsBoolean(c.settings.names.enableCortanaAdaptiveCard),this.enableCortanaAdaptiveCardInput=b.valueAsBoolean(c.settings.names.enableCortanaAdaptiveCardInput),this.disableCortanaCustomStyling=b.valueAsBoolean(c.settings.names.disableCortanaCustomStyling),this.disableInputTitle=b.valueAsBoolean(c.settings.names.enableCortanaAdaptiveCardInput)?"":i.instant(S.strings.cortana_disable_input_message),C.isRigel()&&(this.initScenario=m.newScenario(c.scenarios.cortana.init),this.initializeInternal(this.initScenario))}return t.$inject=["$rootScope","$interval","$scope","$timeout","$translate","analyticsService","brbV2FeedbackService","callingService","constants","cortanaConfigurationService","cortanaEventingService","cortanaLoaderService","eventingService","loggingService","resources","shortcutService","platformDetectService","settingsService","tooltipService","cortanaFREService","utilityService","ariaLiveService","dialogService"],t.prototype.initializeInternal=function(t,e){var a=this;this.logger.info("initializeInternal: Cortana control initializing ..."),this.cortanaLoaderService.getCortanaService(t).then(function(t){return a.cortanaService=t,a.setupCortanaEvents(),a.cortanaConfigurationService.isCortanaEnabled()}).then(function(t){a.isCortanaEnabled=t,t?(e=!a.dialogService.isAnyDialogOpen()&&e)&&a.onCortanaStartClickedHelper(null,!0):a.logger.info("Cortana is disabled")}).catch(function(e){t.fail({errorMessage:e}),a.logger.error("initializeInternal failed, err: "+e)})},t.prototype.setupCortanaEvents=function(){var e=this;this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.enableCortana()},d.initialize),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.disableCortana()},d.destroyed),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.updateCortanaStatus(a)},d.stateChanged),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.updateCortanaText(a,i.Phrase)},d.phraseUpdated),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.updateCortanaText(a,i.DisplayText)},d.messageUpdated),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.updateCortanaText(a,i.AdaptiveCard)},d.adaptiveCardUpdated),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.updateCortanaText(a,i.ErrorMessage)},d.errorMessageUpdated),this.cortanaEventingService.safeSubscribe(this.$scope,function(){return e.hideCortana()},d.dismiss),this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.showSkillCancel(a)},d.skillNotify),this.settingsService.valueFor(this.constants.settings.names.rigel).enableCortanaKwsUx&&(this.showFullCortanaDialog=!1,this.cortanaEventingService.safeSubscribe(this.$scope,function(t,a){return e.updateKwsUx(a)},d.keywordSpotterEvent)),this.eventingService.$on(this.$scope,this.constants.events.cortana.openEducationalPage,function(){return e.onEducationalAction()}),this.popoverContainer=this.popoverContainer||"body",this.popoverPlacement=this.popoverPlacement||"bottom",this.$scope.ctrl={constants:this.constants},this.eventingService.$on(this.$rootScope,this.constants.events.cortana.invoke,function(t,a){if(e.showFullCortanaDialog=!0,null!==a&&"object"==typeof a){var n=a.isCancel,i=a.query;e.startCortana(n,i)}else if("boolean"==typeof a){n=a;e.startCortana(n)}else e.startCortana(!a,a);_.defer(function(){return e.utilityService.digest(e.$scope)})}),this.$scope.$on(this.constants.events.cortana.init,function(t,a){e.logger.info("event cortana.init invoked cortana"),e.isCortanaEnabled&&e.startCortana(a)}),this.$scope.$on("$destroy",function(){e.logger.info("popover destroyed"),e.cortanaInvocationLatencyScenario&&(e.cortanaInvocationLatencyScenario.stop(),e.cortanaInvocationLatencyScenario=null),e.hideCortana(),e.configurationUpdateSubscription&&(e.cortanaConfigurationService.unsubscribe(e.configurationUpdateSubscription),e.configurationUpdateSubscription=null,t.isCortanaOpen=!1),e.consentUpdateSubscription&&(e.cortanaConfigurationService.unsubscribe(e.consentUpdateSubscription),e.consentUpdateSubscription=null)}),this.platformDetectService.isRigel()||this.$scope.$on("tooltip.hide",function(){e.hideCortana()}),this.enableShortcut&&"true"===this.enableShortcut&&(this.logger.info("registering shortcuts"),this.registerShortcuts()),this.setSuggestions(),this.parseCortanaEducationalPageData()},Object.defineProperty(t.prototype,"isCortanaOpen",{get:function(){return t.isCortanaOpen},enumerable:!0,configurable:!0}),t.prototype.sendPsuedoBIEventForCortanaLoaded=function(){this.analyticsService.sendPseudoPanelView({panelType:teamspace.PanelType.cortanaLoaded})},t.prototype.showSkillCancel=function(t){var e=this,a=t.data,n=a.cancelActionCb,i=a.actionDelay,o=a.state;this.cancelActionCb=n,this.logger.info("showing skill execution, state: "+o+", actionDelay: "+i+" s"),t&&"willExecute"===o?(this.showCancelButton=!0,this.cancelTimer=this.$timeout(function(){e.showCancelButton=!1},1e3*i)):(this.showCancelButton=!1,this.cancelActionCb=null,this.$timeout.cancel(this.cancelTimer))},t.prototype.onCancelSkillExecution=function(){this.logger.info("cancel skill execution..."),this.$timeout.cancel(this.cancelTimer),this.cancelActionCb&&(this.cancelActionCb(),this.cancelActionCb=null),this.showCancelButton=!1,this.cortanaService.cancel(),this.cleanUpCortanaResult(!0)},t.prototype.enableCortana=function(){this.logger.info("setting isCortanaEnabled to true"),this.initScenario.stop({cortanaEnabled:!0}),this.isCortanaEnabled=!0,this.sendPsuedoBIEventForCortanaLoaded()},t.prototype.disableCortana=function(){this.logger.info("setting isCortanaEnabled to false"),this.initScenario.stop({cortanaDisabled:!0}),this.isCortanaEnabled=!1},t.prototype.startCortana=function(e,a,n){this.logger.info("starting Cortana, isClear: "+e+", cortanaState: "+this.cortanaState),t.isCortanaOpen&&this.cleanUpCortanaResult(e),this.invokeCortana(a,n)},t.prototype.stopCortana=function(t){this.logger.info("stopping Cortana, isCancel: "+t),t?this.onCancelSkillExecution():this.cortanaService.stopRecognizer()},t.prototype.hideCortana=function(e){if(void 0===e&&(e=!1),t.isCortanaOpen){if(this.logger.info("hiding Cortana, userDismissed: "+e+", cortanaState: "+this.cortanaState),this.$timeout.cancel(this.welcomeTimer),this.welcomeTimer=null,this.welcomeScreenState="hidden",this.feedbackDialogClosedPromise=null,!e&&this.cortanaState!==p.Ready)return this.logger.info("hideCortana invoked due to skill execution, abort"),void(this.previousSkillExecuted=!0);this.stopCortana(e),this.cleanUpCortanaResult(!0),t.isCortanaOpen=!1,this.tooltipService.clearTooltip(teamspace.services.TooltipType.Cortana,this.cortanaTooltipId),this.cortanaKeyboard&&(this.cortanaKeyboard.destroy(),this.cortanaKeyboard=null),this.eventingService.$emit(this.constants.events.cortana.dismissed,e),this.settingsService.valueFor(this.constants.settings.names.rigel).enableCortanaKwsUx&&(this.showFullCortanaDialog=!1)}},t.prototype.openFeedbackDialog=function(){var t=this;this.logger.info("opening feedback dialog..."),this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.openDialog,teamspace.components.PanelActionScenario.cortanaFeedback),this.platformDetectService.isRigel()?this.stopCortana(!0):this.hideCortana(),this.logger.info("cancelling autoCloseCortanaTimer if active"),this.autoCloseCortanaTimer&&this.$timeout.cancel(this.autoCloseCortanaTimer);var e=this.platformDetectService.isRigel()?this.constants.feedback.rigel.categories.cortana:this.constants.feedback.categories.cortana;this.feedbackDialogClosedPromise=this.brbV2FeedbackService.openDialog(!1,void 0,e),this.feedbackDialogClosedPromise.then(function(e){t.logger.info("feedback dialog closed, id: "+e.id)}).finally(function(){t.feedbackDialogClosedPromise=null,t.hideCortana()})},t.prototype.startMicToCortanaAnimation=function(){var t=this;this.timer=this.$timeout(function(){t.isMic2CortanaMorphing=!0},150)},t.prototype.endMicToCortanaAnimation=function(){this.$timeout.cancel(this.timer),this.isMic2CortanaMorphing&&(this.isMic2CortanaMorphing=!1)},t.prototype.onAdaptiveCardReady=function(t){var e=this,a=t.adaptiveCardObject.renderedElement;if(!this.enableCortanaAdaptiveCardInput&&a){var n=a.querySelectorAll("input, select, textarea, button");_.forEach(n,function(t){return t.setAttribute("disabled","")})}a&&($(a).on("keydown",function(t){13!==t.keyCode||!$(t.target).is("button")&&"button"!==$(t.target).attr("role")?($(t.target).is("input")||$(t.target).is("select")||$(t.target).is("textarea"))&&(e.cortanaState!==p.Speaking&&e.cortanaState!==p.Listening||e.stopCortana(!1)):$(t.target).click()}),a.focus())},t.prototype.onWillAdaptiveCardExecuteAction=function(t,e,a,n){if(this.enableCortanaAdaptiveCardInput&&!(e instanceof r.OpenUrlAction)&&e instanceof r.SubmitAction){a.stopPropagation(),a.preventDefault();var i={cardId:this.adaptiveResponses[n].id,inputs:e.data};this.logger.info("adaptive card submit action triggered..."),this.stopCortana(),this.cortanaService.adaptiveCardAction("submit",i)}},t.prototype.onAdaptiveCardClicked=function(t){t&&t.stopPropagation()},t.prototype.onCortanaClicked=function(t){this.cortanaState===p.Speaking&&(this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.complete,teamspace.components.PanelActionScenario.cortanaStopResponding),t.stopPropagation(),t.preventDefault())},t.prototype.onStopListeningClicked=function(t){this.logger.info("stop listening clicked"),this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.complete,teamspace.components.PanelActionScenario.cortanaStopListening),t.stopPropagation(),t.preventDefault(),this.stopCortana()},t.prototype.onCortanaCloseClicked=function(t){this.logger.info("close clicked"),this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.hide,teamspace.components.PanelActionScenario.cortanaClose),t.stopPropagation(),t.preventDefault(),this.hideCortana(!0),this.cortanaInvocationLatencyScenario&&(this.cortanaInvocationLatencyScenario.stop(),this.cortanaInvocationLatencyScenario=null)},t.prototype.onCortanaStartClickedHelper=function(t,e,a){var n=this;this.logger.info("start clicked, isCancel: "+e),t&&(t.stopPropagation(),t.preventDefault()),this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.cortanaInvoke),this.startCortana(e,null,a),e&&(this.ariaLiveService.update(this.$translate.instant(this.resources.strings.cortana_aria_open_popup),!0),this.welcomeScreenState="show",this.welcomeTimer=this.$timeout(function(){n.welcomeScreenState="hiding",n.calculateDefaultState(),n.welcomeTimer=n.$timeout(function(){n.welcomeScreenState="hidden"},500)},5e3),setTimeout(function(){$(".cortana-feedback-button").focus()},100))},t.prototype.onCortanaStartClicked=function(t,e){var a=this.cortanaFREService.isConsentModalRequired();this.logger.info("Cortana start clicked, showConsent: {0}",a),a?(this.welcomeTitle=this.$translate.instant(this.resources.strings.cortana_welcome_title),this.cortanaFREService.showConsentModal()):(this.cortanaInvocationLatencyScenario=this.createNewScenario(this.cortanaInvocationLatencyScenarioName),this.cortanaInvocationLatencyScenario.mark("invoke",this.cortanaService.getCorrelationIdAndServiceTag()),this.onCortanaStartClickedHelper(t,e,this.cortanaInvocationLatencyScenario),this.welcomeTitle=this.$translate.instant(this.resources.strings.cortana_how_can_help))},t.prototype.onHelpButtonClicked=function(t){this.logger.info("help button clicked"),this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.cortanaEduPage),t.stopPropagation(),t.preventDefault(),this.goToEducationalPage()},t.prototype.onGoToHelpPageButtonClicked=function(t){this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.nav,teamspace.components.PanelActionScenario.cortanaGoToHelp),this.stopCortana()},t.prototype.goToEducationalPage=function(){this.cortanaState!==p.Ready&&this.stopCortana(!1),this.cleanUpCortanaResult(!0),this.educationalPageNumber=1,this.$timeout(function(){$(".cortana-educational-itemlist").focus()})},t.prototype.onSubHelpBackButtonClicked=function(t){t.stopPropagation(),t.preventDefault(),this.educationalPageNumber=1},t.prototype.onSubHelpBackButtonClickedRigel=function(t){t.stopPropagation(),t.preventDefault(),this.platformDetectService.isRigel()&&(this.educationalPageNumber=1)},t.prototype.selectHelpOption=function(t){this.logger.info("Entering "+t.title+" tips "),this.selectedHelpOption=t,this.educationalPageNumber=2;var e=[t.title,t.suggestions.join(" ")].join();this.ariaLiveService.update(e);var a="cortana"+t.title.replace(/\s/g,"")+"Tips";this.logTelemetry(teamspace.components.PanelActionGesture.click,teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.cortanaEduCategorySelect,teamspace.components.PanelModuleType.listItem,teamspace.components.PanelModuleName[a])},t.prototype.calculateDefaultState=function(){var t=this,e=!(this.displayText||this.adaptiveResponses||this.phraseString||this.cortanaState!==p.Ready&&this.cortanaState!==p.Listening);if(!(this.cortanaState===p.Thinking||e&&"show"===this.welcomeScreenState))if(this.showDefaultState=e,this.showDefaultState&&!this.suggestionsTimer){var a=function(){return 0===t.educationalPageNumber&&t.updateSuggestions(),a};this.suggestionsTimer=this.$interval(a(),5e3)}else!this.showDefaultState&&this.suggestionsTimer&&(this.$interval.cancel(this.suggestionsTimer),this.suggestionsTimer=null,this.$interval.cancel(this.welcomeTimer),this.welcomeScreenState="hidden")},t.prototype.registerShortcuts=function(){var t=this;this.shortcutService.assignCommandHandler(teamspace.services.CommandIdentifier.InvokeCortana,function(){t.logTelemetry(teamspace.components.PanelActionGesture.kbshort,teamspace.components.PanelActionOutcome.show,teamspace.components.PanelActionScenario.cortanaInvoke),t.startCortana(!1)},this.$scope)},t.prototype.invokeCortana=function(t,e){this.logger.info("invoking Cortana..."),this.pendingEducationalAction=!1,this.cortanaErrorMessage="",this.cortanaState!==p.Ready&&this.cortanaState!==p.Speaking||(t?this.cortanaService.queryCortana(t):this.cortanaService.startRecognizer(e)),this.showCortana(),this.calculateRetryButton()},t.prototype.showCortana=function(){var e=this;if(!t.isCortanaOpen){this.logger.info("showing Cortana..."),this.platformDetectService.isRigel()&&this.setSuggestions(),this.adaptiveResponses=null,this.tooltipService.clearTooltip(teamspace.services.TooltipType.Cortana,this.cortanaTooltipId),t.isCortanaOpen=!0,this.suggestionIndex=0,this.educationalPageNumber=0;var a={templateUrl:"components/cortana/cortana/cortana-popover.html",trigger:"manual",container:this.popoverContainer,scope:this.$scope,autoClose:!1,placement:this.popoverPlacement,target:angular.element(this.popoverContainer)},n={sourceElement:angular.element(this.popoverContainer),tooltipType:teamspace.services.TooltipType.Cortana,options:a,tooltipId:this.cortanaTooltipId};this.tooltipService.showTooltip(n),this.cortanaKeyboard=new teamspace.accessibility.Keyboard(new teamspace.accessibility.NgIAugmentedJQueryAdapter(angular.element(document.body))),this.cortanaKeyboard.onEscapeKey(function(){e.logTelemetry(teamspace.components.PanelActionGesture.kbshort,teamspace.components.PanelActionOutcome.hide,teamspace.components.PanelActionScenario.cortanaClose),e.hideCortana(!0)}),this.showFullCortanaDialog&&this.eventingService.$emit(this.constants.events.cortana.activated)}},t.prototype.updateCortanaStatus=function(e){var a=e.data;switch(this.setStateAndIcon(a),this.startOrStopAutoCloseTimer(),a){case p.Ready:this.previousSkillExecuted&&this.hideCortana(),this.previousSkillExecuted=!1;break;case p.Listening:this.cortanaErrorMessage="",t.isCortanaOpen||this.showCortana();break;case p.Thinking:this.displayText="",0!==this.educationalPageNumber&&(this.educationalPageNumber=0);break;case p.Speaking:}this.calculateDefaultState(),this.calculateRetryButton(),this.cortanaState===p.Ready&&this.pendingEducationalAction&&(this.pendingEducationalAction=!1,this.goToEducationalPage())},t.prototype.updateKwsUx=function(t){switch(t.data){case u.LocalKwsAccept:this.showFullCortanaDialog=!1;break;case u.ServiceKwsAccept:this.showFullCortanaDialog=!0,this.eventingService.$emit(this.constants.events.cortana.activated);break;case u.ServiceKwsReject:this.logger.info("Received Kws Reject"),this.showFullCortanaDialog=!0,this.hideCortana()}},t.prototype.calculateRetryButton=function(){this.showRetryButton=!this.cortanaErrorMessage&&this.cortanaState===p.Ready||this.cortanaState===p.Speaking},t.prototype.setStateAndIcon=function(t){this.cortanaState!==t&&(this.cortanaIcon=g[t],this.cortanaState=t)},t.prototype.updateCortanaText=function(t,e){var a=t.data;if(this.phraseString="",e===i.ErrorMessage)return this.cortanaErrorMessage=a,void(this.cortanaInvocationLatencyScenario&&(this.cortanaInvocationLatencyScenario.stop(),this.cortanaInvocationLatencyScenario=null));e!==i.AdaptiveCard&&e!==i.Phrase&&(this.displayText=""),e===i.DisplayText&&(this.adaptiveResponses=null),e===i.DisplayText?this.displayText=a||"":e===i.AdaptiveCard&&this.enableAdaptiveCard?this.adaptiveResponses=a||null:e===i.Phrase&&(this.phraseString=a||""),this.calculateDefaultState()},t.prototype.cleanUpCortanaResult=function(t){this.logger.info("clean up Cortana result, cleanDisplayTextAndCard: "+t),this.phraseString="",t&&(this.displayText="",this.cortanaErrorMessage="",this.adaptiveResponses=null),this.calculateDefaultState()},t.prototype.setSuggestions=function(){this.suggestions=this.platformDetectService.isRigel()?this.callingService.getActiveCall()?this.getMTRInMeetingSuggestions():c.CortanaHelpData.IDLE_SUGGESTIONS_RIGEL:c.CortanaHelpData.IDLE_SUGGESTIONS},t.prototype.getMTRInMeetingSuggestions=function(){var t=c.CortanaHelpData.IN_MEETING_SUGGESTIONS_RIGEL;return this.settingsService.valueFor(this.constants.settings.names.rigel).enableCortanaFastFollow&&t.concat(c.CortanaHelpData.IN_MEETING_SUGGESTIONS_RIGEL_CALLING),this.settingsService.valueFor(this.constants.settings.names.rigel).enableCortanaPresentations&&t.concat(c.CortanaHelpData.IN_MEETING_SUGGESTIONS_RIGEL_PRESENTATIONS),t},t.prototype.parseCortanaEducationalPageData=function(){var t=this;if(!this.helpOptions||!this.helpOptions.length)if(this.platformDetectService.isRigel())this.helpOptions.push(c.CortanaHelpData.EDUCATIONAL_PAGE_RIGEL),this.settingsService.valueFor(this.constants.settings.names.rigel).enableCortanaFastFollow&&this.helpOptions.push(c.CortanaHelpData.EDUCATIONAL_PAGE_RIGEL_CALLING),this.settingsService.valueFor(this.constants.settings.names.rigel).enableCortanaPresentations&&this.helpOptions.push(c.CortanaHelpData.EDUCATIONAL_PAGE_RIGEL_PRESENTATIONS);else{var e=c.CortanaHelpData.EDUCATIONAL_PAGE;e.items.forEach(function(a){t.helpOptions.push(e.itemData[a])})}},t.prototype.updateSuggestions=function(){this.suggestionIndex=++this.suggestionIndex%this.suggestions.length},t.prototype.onEducationalAction=function(){this.cortanaState===p.Ready?this.goToEducationalPage():this.pendingEducationalAction=!0},t.prototype.canAutoClose=function(){return t.isCortanaOpen&&this.cortanaState===p.Ready&&!this.showCancelButton&&(!this.platformDetectService.isRigel()||!this.feedbackDialogClosedPromise)},t.prototype.startOrStopAutoCloseTimer=function(){var t=this;this.canAutoClose()&&!this.autoCloseCortanaTimer?(this.logger.info("auto-close after 7000 ms ..."),this.autoCloseCortanaTimer=this.$timeout(function(){t.hideCortana(),t.autoCloseCortanaTimer=null},7e3)):this.autoCloseCortanaTimer&&(this.logger.info("cancelling the auto-close timer"),this.$timeout.cancel(this.autoCloseCortanaTimer),this.autoCloseCortanaTimer=null)},t.prototype.logTelemetry=function(t,e,a,n,i){var o={actionGesture:t,actionOutcome:e,actionScenario:a,actionScenarioType:teamspace.components.PanelActionScenarioType.cortana,moduleType:n||teamspace.components.PanelModuleType.cortana,moduleName:i||teamspace.components.PanelModuleName.cortanaSkill,moduleSummary:"",dataBag:{cortanaState:this.cortanaState||""}};l.logTelemetry(o,this.loggingService,this.analyticsService)},t.prototype.createNewScenario=function(t){var e=this.loggingService.findScenario(t);return e&&e.stop(),e=this.loggingService.newScenario(t)},t.isCortanaOpen=!1,t}();e.CortanaController=v,angular.module("teamspace.cortana",["teamspace.analyticsService","teamspace.brbV2FeedbackService","teamspace.callingService","teamspace.constants","teamspace.cortanaConfigurationService","teamspace.cortanaEventingService","teamspace.cortanaFREService","teamspace.cortanaLoaderService","teamspace.engagementSurfaceService","teamspace.eventingService","teamspace.loggingService","teamspace.platformDetectService","teamspace.settingsService","teamspace.tooltipService","teamspace.dialogService","teamspace.utilityService"]).directive("cortana",function(){return{restrict:"E",scope:{},bindToController:{popoverContainer:"@?",popoverPlacement:"@?",enableShortcut:"@?"},controllerAs:"cortana",templateUrl:"components/cortana/cortana/cortana.html",controller:v}}).run(["$templateCache",function(t){t.put("components/cortana/cortana/cortana.html",o),t.put("components/cortana/cortana/cortana-popover.html",s)}])},2711:function(t,e){t.exports='<div ng-if="cortana.isCortanaEnabled" class="cortana-container">\n  <button acc-role="tab-handler-cortana-button" data-tid="cortana-button" title="{{::$root.resources.strings.cortana_button | translate}}" class="cortana-button ts-sym inset-border inset-border-round inset-border-themed" ng-mouseenter="cortana.startMicToCortanaAnimation()" ng-mouseleave="cortana.endMicToCortanaAnimation()" ng-class="{\'active\': cortana.cortanaState !== \'ready\'}" ng-click="cortana.onCortanaStartClicked($event, true)" track-click-silent="true">\n\n    <div class="mic2cortana-container">\n      <div class="mic2cortana-anim" ng-class="{\'mic2cortana-anim-forward\': cortana.isMic2CortanaMorphing, \'mic2cortana-anim-reversed\': !cortana.isMic2CortanaMorphing}">\n        <svg-include aria-hidden="true" src="\'svg/icons-mic-to-cortana-morph.html\'"></svg-include>\n      </div>\n    </div>\n  </button>\n</div>'},2712:function(t,e){t.exports='<div class="cortana-popover-container popover minwidth-sm maxwidth-common" ng-class="{ \'has-card\': (cortana.educationalPageNumber !== 0 || cortana.adaptiveResponses && !cortana.showDefaultState),\n      \'is-mini-cortana\': (!cortana.showFullCortanaDialog)}" data-tid="cortana-popover-container" ng-click="cortana.onCortanaClicked($event)" role="dialog" acc-role="tab-handler-cortana-main" track-click-silent="true">\n\n  <div class="cortana-background" ng-class="{\n      \'modal-mode\': (!!cortana.callingService.getActiveCall()),\n      \'hidden\': (!cortana.platformDetectService.isRigel())\n    }" ng-if="cortana.showFullCortanaDialog">\n  </div>\n  <div class="cortana-foreground-modal" ng-if="cortana.showFullCortanaDialog">\n  </div>\n  <div class="cortana-foreground-content" ng-if="cortana.showFullCortanaDialog">\n    <div class="state-icon">\n      <div class="icon-container" ng-class="cortana.cortanaState">\n        <div class="icon action" ng-class="cortana.cortanaState" style="background-image: url(\'{{cortana.cortanaIcon}}\')"></div>\n      </div>\n    </div>\n\n    <div ng-if="cortana.educationalPageNumber===0">\n      <div class="cortana-content default-state" ng-if="cortana.showDefaultState">\n        <div>\n          \x3c!-- Default idle state--\x3e\n          <div class="cortana-display-title" aria-live="{{cortana.welcomeTitle}}" ng-class="{ \'cycling\': cortana.welcomeScreenState === \'show\', \'hidden\': cortana.welcomeScreenState !== \'show\'}">{{cortana.welcomeTitle}}\n          </div>\n          <div class="cortana-display-title" aria-live="{{::$root.resources.strings.cortana_default_title|translate}}" ng-class="{ \'cycling\': cortana.welcomeScreenState === \'hiding\', \'hidden\': cortana.welcomeScreenState === \'show\'}">{{::$root.resources.strings.cortana_default_title|translate}}\n          </div>\n        </div>\n\n        <div class="cortana-suggestions" ng-class="{ \'cortana-visibility-hidden\': cortana.welcomeScreenState === \'show\' }">\n          <div class="cortana-suggestion-list">\n            <div class="cortana-default-text" ng-class="{ \'cycling\':  $index === cortana.suggestionIndex && cortana.welcomeScreenState !== \'show\', \'hidden\': $index !== cortana.suggestionIndex }" ng-repeat="suggestion in cortana.suggestions track by $index">\n              {{ suggestion }}\n            </div>\n          </div>\n        </div>\n\n        <button class="cortana-help-button-center ts-sym app-icons-fill-hover app-icons-fill-focus cortana-default-text inset-border inset-border-themed" type="button" ng-class="{ \'cycling\': cortana.welcomeScreenState === \'hiding\', \'cortana-visibility-hidden\': cortana.welcomeScreenState === \'show\'}" ng-click="cortana.onHelpButtonClicked($event)" track-click-silent="true" aria-label="{{::$root.resources.strings.cortana_all_tips_center | translate}}" title="{{::$root.resources.strings.cortana_all_tips_center | translate}}">\n          <span class="all-tips-center-text">{{::$root.resources.strings.cortana_all_tips_center | translate}}</span>\n        </button>\n      </div>\n\n      <div class="cortana-content text header" ng-class="{\'content-margin\': !cortana.showDefaultState && cortana.displayText && !cortana.adaptiveResponses}">\n        <span class="result" ng-if="cortana.displayText" aria-live="{{cortana.displayText}}">{{cortana.displayText}}</span>\n      </div>\n\n      <div title="{{cortana.disableInputTitle}}" ng-class="{\'disable-input\': !cortana.enableCortanaAdaptiveCardInput, \'adaptive-card-wrapper\': !cortana.disableCortanaCustomStyling, \'cortana-adaptive-card-wrapper-without-style\': cortana.disableCortanaCustomStyling}" ng-click="cortana.onAdaptiveCardClicked($event)">\n        <div ng-if="cortana.adaptiveResponses && !cortana.showDefaultState" simple-scrollbar scrollbar-ignore-firefox-adjust="false">\n          <div class="scroll-wrapper">\n            <div class="cortana-adaptive-card" ng-repeat="adaptiveResponse in cortana.adaptiveResponses">\n              <div oc-lazy-load="adaptive-card">\n                <adaptive-card payload="adaptiveResponse.adaptive" show-card-border="true" on-ready="cortana.onAdaptiveCardReady($ctrl)" host-config-default="cortana.hostConfigDefault" host-config-dark="cortana.hostConfigDefault" host-config-contrast="cortana.hostConfigDefault" on-will-execute-action="cortana.onWillAdaptiveCardExecuteAction($ctrl, $action, $event, $index)">\n                </adaptive-card>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="cortana-content text" ng-if="cortana.phraseString">\n        <span class="phrase">{{cortana.phraseString}}</span>\n      </div>\n      <div class="cortana-cancel-action" ng-if="cortana.showCancelButton">\n        <button class="ts-btn ts-btn-fluent ts-btn-fluent-secondary" ng-click="cortana.onCancelSkillExecution($event)">Cancel</button>\n      </div>\n    </div>\n\n    \x3c!-- Educational page --\x3e\n    <div ng-if="cortana.educationalPageNumber===1">\n      <div class="educational-menu">\n        <div class="cortana-scrollbar" simple-scrollbar scrollbar-ignore-firefox-adjust="false">\n          <div acc-role="listgrid-horizontal-and-vertical" class="item-list cortana-educational-itemlist" role="list">\n            <div acc-role="listgrid-item" class="educational-menu-item-wrapper" ng-click="cortana.selectHelpOption(helpOption)" ng-repeat="helpOption in cortana.helpOptions track by helpOption.title" track-click-silent="true">\n              <div class="educational-menu-item">\n                <div class="menu-item menu-icon">\n                  <ng-include src="::helpOption.icon" aria-hidden="true"></ng-include>\n                </div>\n                <div class="menu-item menu-content">\n                  <div class="menu-title">{{::helpOption.title}}</div>\n                  <div class="menu-description" title="{{::helpOption.description}}">{{::helpOption.description}}</div>\n                </div>\n                <div class="menu-item menu-control">\n                  <ng-include src="\'svg/icons-patharrow-large.html\'" aria-hidden="true"></ng-include>\n                </div>\n              </div>\n              <div ng-if="!$last" class="menu-item-horizontal-separator"></div>\n            </div>\n          </div>\n          <div class="more-indicator-bottom"></div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Educational sub-page --\x3e\n    <div ng-if="cortana.educationalPageNumber===2">\n      <div class="educational-menu sub-menu">\n        <button class="cortana-back-button ts-sym app-icons-fill-hover app-icons-fill-focus inset-border inset-border-round inset-border-themed" type="button" aria-label="{{::$root.resources.strings.cortana_help_back_button | translate}}" ng-click="cortana.onSubHelpBackButtonClicked($event)" title="{{::$root.resources.strings.cortana_help_back_button | translate}}" track-click-silent="true">\n          <ng-include src="\'svg/icons-chevronmed-left.html\'"></ng-include>\n        </button>\n        <div class="cortana-scrollbar" simple-scrollbar scrollbar-ignore-firefox-adjust="false">\n          <div class="educational-menu-content">\n            <div class="menu-header" ng-class="{\'menu-header-rigel\': cortana.platformDetectService.isRigel()}" ng-click="cortana.onSubHelpBackButtonClickedRigel($event)">\n              <div class="menu-item menu-icon">\n                <ng-include src="::cortana.selectedHelpOption.icon" aria-hidden="true"></ng-include>\n              </div>\n              <div class="menu-item title menu-title" aria-label="{{::cortana.selectedHelpOption.title}}" title="{{::cortana.selectedHelpOption.title}}" role="title">{{::cortana.selectedHelpOption.title}}</div>\n            </div>\n            <div class="sub-menu-horizontal-separator"></div>\n            <div class="sub-menu-content">\n              <div class="sub-option" role="listitem" ng-repeat="helpSubOption in cortana.selectedHelpOption.suggestions">\n                    <span aria-label="{{::helpSubOption}">{{::helpSubOption}}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    \x3c!-- Buttons --\x3e\n    <div class="cortana-footer">\n      <button class="cortana-feedback-button ts-sym app-icons-fill-hover app-icons-fill-focus inset-border inset-border-themed" type="button" ng-click="cortana.openFeedbackDialog($event)" track-click-silent="true" title="{{::$root.resources.strings.cortana_send_feedback_aria_label|translate}}" aria-label="{{::$root.resources.strings.cortana_send_feedback_aria_label|translate}}">\n        <ng-include class="feedback-icon" src="\'svg/icons-feedback.html\'"></ng-include>\n        <span class="feedback-text" translate-once="{{::$root.resources.strings.cortana_feedback_button_text}}"></span>\n      </button>\n      <button class="ts-sym cortana-retry-icon app-icons-fill-hover app-icons-fill-focus inset-border inset-border-themed" ng-if="cortana.showRetryButton && !cortana.showCancelButton" ng-click="cortana.onCortanaStartClicked($event, false)" aria-label="{{ ::$root.resources.strings.cortana_aria_start_listening|translate}}" title="{{ ::$root.resources.strings.cortana_click_talk_to_cortana|translate}}" track-click-silent="true">\n        <ng-include aria-hidden="true" src="\'svg/icons-cortana-mic.html\'"></ng-include>\n      </button>\n      <button ng-if="cortana.cortanaState==\'listening\'" class="ts-sym cortana-main-action cortana-sound-wrapper app-icons-fill-hover app-icons-fill-focus inset-border inset-border-themed" ng-click="cortana.onStopListeningClicked($event)" aria-label="{{ ::$root.resources.strings.cortana_aria_stop_listening|translate}}" track-click-silent="true">\n        <div class="cortana-sound">\n          <div class="wave wave1 wave-active-1"></div>\n          <div class="wave wave2 wave-active-2"></div>\n          <div class="wave wave3 wave-active-3"></div>\n          <div class="wave wave4 wave-active-4"></div>\n          <div class="wave wave5 wave-active-5"></div>\n          <div class="wave wave6 wave-active-6"></div>\n          <div class="wave wave7 wave-active-7"></div>\n          <div class="wave wave8 wave-active-8"></div>\n          <div class="wave wave9 wave-active-9"></div>\n          <div class="wave wave10 wave-active-10"></div>\n          <div class="wave wave11 wave-active-11"></div>\n          <div class="wave wave12 wave-active-12"></div>\n          <div class="wave wave13 wave-active-13"></div>\n          <div class="wave wave14 wave-active-14"></div>\n          <div class="wave wave15 wave-active-15"></div>\n          <div class="wave wave16 wave-active-16"></div>\n          <div class="wave wave17 wave-active-17"></div>\n          <div class="wave wave18 wave-active-18"></div>\n          <div class="wave wave19 wave-active-19"></div>\n          <div class="wave wave20 wave-active-20"></div>\n          <div class="wave wave21 wave-active-21"></div>\n          <div class="wave wave22 wave-active-22"></div>\n          <div class="wave wave23 wave-active-23"></div>\n          <div class="wave wave24 wave-active-24"></div>\n          <div class="wave wave25 wave-active-25"></div>\n        </div>\n      </button>\n      <div ng-if="cortana.cortanaErrorMessage" class="cortana-error">\n        <span>{{cortana.cortanaErrorMessage}}</span>\n      </div>\n      \x3c!-- Go to Educational page button--\x3e\n      <button class="cortana-help-button bottom-right-help ts-sym app-icons-fill-hover app-icons-fill-focus inset-border inset-border-themed" type="button" ng-if="cortana.educationalPageNumber===0 && !cortana.showDefaultState" ng-click="cortana.onHelpButtonClicked($event)" track-click-silent="true" aria-label="{{::$root.resources.strings.cortana_all_tips | translate}}" title="{{::$root.resources.strings.cortana_all_tips | translate}}">\n        <span class="all-tips-text">{{::$root.resources.strings.cortana_all_tips | translate}}</span>\n      </button>\n      \x3c!-- Go to help page button --\x3e\n      <a ng-if="cortana.educationalPageNumber!==0" class="cortana-help-button ts-sym app-icons-fill-hover app-icons-fill-focus inset-border inset-border-themed" track-click-silent="true" ng-href="{{::cortana.helpPageUrl}}" ng-click="cortana.onGoToHelpPageButtonClicked($event)" target="_blank" title="{{::$root.resources.strings.cortana_go_to_help | translate}}" rel="noopener noreferrer">\n        <span class="go-to-help-text">{{::$root.resources.strings.cortana_go_to_help | translate}}</span>\n      </a>\n    </div>\n\n    <button class="cortana-close-button ts-btn app-icons-fill-hover app-icons-fill-focus inset-border inset-border-round inset-border-themed" ng-click="cortana.onCortanaCloseClicked($event)" track-click-silent="true" acc-role="tab-handler-cortana-close" title="{{ ::$root.resources.strings.icons_close|translate}}" aria-label="{{ ::$root.resources.strings.icons_close|translate}}">\n      <ng-include class="icon" src="\'svg/icons-close-cortana.html\'" role="presentation"></ng-include>\n    </button>\n  </div>\n  <div class="cortana-mini" ng-if="!cortana.showFullCortanaDialog">\n    <div class="cortana-icon">\n      <svg-include aria-hidden="true" src="\'svg/icons-cortana-false-accept.html\'"></svg-include>\n    </div>\n  </div>\n</div>\n'},2713:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.EDUCATIONAL_PAGE={items:["calling","navigation","meeting","user_activity","calendar","files","chat","help"],itemData:{calling:{icon:"svg/icons-call.html",title:"Calling",description:'"Call Krista."',suggestions:['"Call Krista."','"Call 555-123-4567."','"Add Padma to the call."','"Add 555-123-4567 to the call."','"Hang up."','"Transfer the call to Krista."','"Transfer the call to my mobile."','"Put the call on hold."']},navigation:{icon:"svg/icons-forward-arrow.html",title:"Navigation",description:'"Go to Settings."',suggestions:['"Go to Settings."','"Go to Downloads."','"Go to Saved Messages."','"Search for status report."']},meeting:{icon:"svg/icons-calendar.html",title:"Meeting",description:'"Join the meeting."',suggestions:['"Join the meeting."','"Add Padma to the meeting."','"Present the deck I was working on."','"Present the sales projection deck."','"Go to the appendix slide."','"Stop presention."','"End the meeting."']},user_activity:{icon:"svg/icons-bell.html",title:"User Activity",description:'"Show me My Activity."',suggestions:['"Show me My Activity."','"Show me where I was mentioned."','"Go to my unread activity."','"Change my status to busy."']},calendar:{icon:"svg/icons-schedule.html",title:"Calendar",description:'"What meetings do I have tomorrow?"',suggestions:['"What meetings do I have tomorrow?"','"What meetings do I have on February 5th?"','"Cancel my 2 PM meeting."','"Cancel my meeting with Myron."','"Cancel my Morning Status meeting."','"Show my calendar."']},files:{icon:"svg/icons-document.html",title:"Files",description:'"Download this file."',suggestions:['"Download this file."','"Open the Q4 sales spreadsheet."','"Open the marketing OneNote."','"Show me my recent files."','"Share this file with Jane."','"Share the training document with Alex."']},chat:{icon:"svg/icons-chat.html",title:"Chat",description:'"Send a message to Shiori."',suggestions:['"Send a message to Shiori."','"Send a message to Alex that I am running late."','"Message my next meeting I am running late."']},help:{icon:"svg/icons-faq.html",title:"Help",description:'"Help"',suggestions:['"Help"','"Send feedback."']}}},t.IDLE_SUGGESTIONS=['"When is my next meeting?"','"Join the meeting"','"Call Alex Smith"','"Send a message to Lauren"','"Open the PowerPoint I was working on"','"Cancel my 3pm meeting"','"Show my calendar"','"Show me my at mentions"','"Set my status to busy"'],t.EDUCATIONAL_PAGE_RIGEL={icon:"svg/icons-calendar-large.html",title:"Meetings",description:'"Join the next meeting"',suggestions:['"Join the current meeting"','"End meeting"','"Add John Smith to the meeting"','"Add 555-123-4567 to the meeting"']},t.EDUCATIONAL_PAGE_RIGEL_CALLING={icon:"svg/icons-call-large.html",title:"Calling",description:'"Call Ellis"',suggestions:['"Call Ellis"','"Call 555-123-4567"','"Add Kayo to the Call"','"Add 555-123-4567 to the call"','"End Call"']},t.EDUCATIONAL_PAGE_RIGEL_PRESENTATIONS={icon:"svg/icons-mtr-cortana-presentation.html",title:"Presenting",description:'"Present the planning deck"',suggestions:['"Present the planning deck​"','"Share the marketing presentation"','"Go to slide 5"','"Next slide"','"Previous slide"','"Go forward 3 slides"','"Go back 2 slides"','"Stop presenting"']},t.IDLE_SUGGESTIONS_RIGEL=['"Join my next meeting."','"Call John Smith"','"Call 555-123-4567."'],t.IN_MEETING_SUGGESTIONS_RIGEL=['"End the meeting."','"Add 555-123-4567 to the meeting."'],t.IN_MEETING_SUGGESTIONS_RIGEL_CALLING=['"Add John Smith to the meeting"'],t.IN_MEETING_SUGGESTIONS_RIGEL_PRESENTATIONS=['"Present the deck"','"Present the planning deck"','"Go to slide 5​"','"Next slide"','"Previous slide"','"Stop presenting"​'],t}();e.CortanaHelpData=n}},[2709]);