webpackJsonp([19],{2822:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i(2823),i(2825),i(2827),i(2829),i(2831),i(2833),i(2835)},2823:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2824),s=function(){function e(e,t,i,n,s,a,r,o,l,c,m,d,h){var u=this;this.constants=e,this.$scope=t,this.loggingService=i,this.$translate=n,this.dialogService=s,this.$timeout=a,this.ngDialog=r,this.resources=o,this.ariaLiveService=l,this.settingsService=c,this.utilityService=m,this.$q=d,this.$element=h,this.previewIsRequested=!0,this.attachEnable=!0,this.showPlaceholderElement=!1,this.isWarning=!1,this.media=null,this.mediaArray=[],this.mediaArr=[],this.isAttached=!0,this.focusableElements=null,this.errorPlaceHolder=!1,this.attachfilesClicked=!1,this.attachPictures="",this.camera="",this.attach="",this.maxAttachment=0,this.totalCaptures=0,this.removeButton="",this.fileName="",this.selectMediaPermissions=!1,this.toggleCamera=!1,this.onlyGalleryMode=!1,this.closeCallback=!1,this.counter=0,this.countImages=0,this.mapImage=new Map,this.counter=0,this.countImages=0,this.scrollElements=[],this.showPrevious=!1,this.showNext=!1,this.imageUrl="",this.attachPictures=n.instant(o.strings.select_media_attach_pictures),this.camera=n.instant(o.strings.select_media_return_to_camera),this.attach=n.instant(o.strings.select_media_attach_button),this.removeButton=n.instant(o.strings.select_media_remove_button),this.ariaOnCaptureImage=n.instant(o.strings.select_media_on_capture_aria_label),this.ariaOnImageSelected=n.instant(o.strings.select_media_on_image_selection_aria_label),this.ariaOnSingleImageAttached=n.instant(o.strings.select_media_on_single_image_attached);var g=JSON.parse(t.ctrl.mediaInputs);this.maxAttachment=(g.maxMediaCount<=0?e.mediaConstants.limits.maxSelection:g.maxMediaCount)-1;var v=g.imageProps;v&&v.sources&&(v.sources.indexOf(2)<0?this.attachEnable=!1:1===v.sources.length&&v.sources[0]===teamspace.services.microsoftTeamsInternal.Source.Gallery&&(this.onlyGalleryMode=!0)),v&&v.cameraSwitcher&&(this.toggleCamera=!0),t.attach=function(){u.mapImage.size>0&&(u.previewIsRequested=!1,u.mapImage.forEach(function(e){u.postCallback(e)}),u.closeDialog())}}return e.$inject=["constants","$scope","loggingService","$translate","dialogService","$timeout","ngDialog","resources","ariaLiveService","settingsService","utilityService","$q","$element"],e.prototype.postCallback=function(e){var t=this.utilityService.dataURItoBlob(e),i={dataUri:e,objUrl:URL.createObjectURL(t)};this.setCallback(i)},e.prototype.$onInit=function(){var e=this;this.onlyGalleryMode&&this.$timeout(function(){e.getElementById("attachButton").click()})},e.prototype.setPermission=function(e){var t=this;this.selectMediaPermissions=e,this.selectMediaPermissions&&(this.getElementByClass("ts-select-media-vdi").classList.add("full-height"),this.loggingService.event(this.constants.events.mediaApiEvents.startSelectMediaLoaded),this.$timeout(function(){document.getElementsByClassName("ngdialog-overlay")[0].style.backgroundColor="rgba(37, 36, 35, 0.75)",t.openModal()}))},e.prototype.setCallback=function(e){this.$scope.ctrl.attachCallback({callback:e})},e.prototype.setImageData=function(e,t){return{id:e,data:t}},e.prototype.getElementById=function(e){return this.$element.find("#"+e)[0]},e.prototype.getElementByClass=function(e){return this.$element.find("."+e)[0]},e.prototype.close=function(e){var t=this;if(0===this.mapImage.size)this.previewIsRequested=!1,this.closeDialog();else{var i={okButtonText:this.$translate.instant(this.resources.strings.select_media_close_button_continue_dialog),closeButtonText:this.$translate.instant(this.resources.strings.chat_discard),confirmMessageTitle:this.$translate.instant(this.resources.strings.select_media_close_button_unsaved_dialog),confirmMessageHtmlBody:this.$translate.instant(this.resources.strings.select_media_close_dialog_text),addCloseButton:!0,callback:function(){t.closeCallback=!0}},n=this.dialogService.open(this.constants.dialogs.confirmDialog,i);n.closePromise.then(function(){t.closeCallback||(t.$scope.ngDialog=n,t.closeDialog()),t.closeCallback=!1})}},e.prototype.getVideoErrors=function(e){this.setCallback(e),this.ngDialog.closeAll()},e.prototype.closeDialog=function(){this.previewIsRequested=!1,this.onlyGalleryMode||this.focusedElementBeforeModal.focus(),this.ngDialog.closeAll()},e.prototype.initializeGalleryMode=function(){var e=this;this.$timeout(function(){var t=e.getElementById("attachButton");t.files.length?e.previewFileAttachment(t.files):e.closeDialog()},1e3)},e.prototype.checkForSelectionInFileBrowser=function(e){var t=this.getElementById("attachButton");t.files.length?this.previewFileAttachment(t.files):this.counter++},e.prototype.previewFileAttachment=function(e){var t=this;if(e||this.closeDialog(),this.attachfilesClicked=!0,this.mediaArray=[],this.countImages=this.mapImage.size,e.length>1?(this.ariaOnMultipleImageAttached=this.$translate.instant(this.resources.strings.select_media_on_multiple_image_attached,{attachCnt:e.length}),this.ariaLiveService.update(this.ariaOnMultipleImageAttached,!0)):this.ariaLiveService.update(this.ariaOnSingleImageAttached,!0),this.validatesFiles(e)){for(var i=this,n=0;n<e.length;n++)!function(n){var s=e[n];s?(i.fileName=s.name,i.file=s,i.readImageAsBase64(s).then(function(i){_.isEmpty(i)||(t.onlyGalleryMode?(t.postCallback(i.data),n===e.length-1&&t.closeDialog()):(t.mediaArr=t.mediaArray,t.addToScrollElement(i)))}).catch(function(e){t.showErrorDialog(e.name,e.message)})):i.showErrorDialog(services.microsoftTeamsInternal.sdkErrorMessages.INVALID_FILE,"Invalid Input File, not an image file.")}(n);this.$timeout(function(){t.getElementById("attachButton").focus()})}else this.onlyGalleryMode&&this.closeDialog()},e.prototype.validatesFiles=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i&&(this.fileName=i.name,this.file=i,!this.validateFileAttachment(i)))return this.showErrorDialog(teamspace.services.microsoftTeamsInternal.sdkErrorMessages.INVALID_FILE,teamspace.services.microsoftTeamsInternal.sdkErrorMessages.INVALID_FILE),!1}return!0},e.prototype.validateFileAttachment=function(e){return!!["image/gif","image/jpeg","image/png","image/jpg","image/jfif"].includes(e.type)},e.prototype.readImageAsBase64=function(e){var t=this,i=this.$q.defer(),n=new FileReader;return n.readAsDataURL(e),n.onload=function(e){i.resolve(e.target.result)},i.promise.then(function(e){t.counter++;var i=t.createImageObject(e,t.counter);return!t.isMaxSelected()&&t.maxAttachment>=t.countImages+t.mediaArray.length?(t.mediaArray.push(i),i):(t.warningText=t.$translate.instant(t.resources.strings.select_media_warning_text_max_media_equal_to_one),t.maxAttachment>1&&(t.warningText=t.$translate.instant(t.resources.strings.select_media_warning_text_max_media_greater_than_one,{maxAttachment:t.maxAttachment+1})),t.isWarning=!0,void t.$timeout(function(){t.getElementById("close-warning").focus()}))}).catch(function(e){t.showErrorDialog("Load local image failed",e)})},e.prototype.onKeyUp=function(e){e.which===this.constants.keyCodes.enter&&this.$scope.$broadcast(this.constants.events.mediaApiEvents.startSelectMedia),e.which===this.constants.keyCodes.escape&&this.close(this.constants.events.mediaApiEvents.selectMediaClosedByEscape)},e.prototype.onKeyPress=function(e){e.which===this.constants.keyCodes.enter&&(this.focusScrollElementByClick(e),this.ariaLiveService.update(this.ariaOnImageSelected,!0))},e.prototype.$onDestroy=function(){this.media=null},e.prototype.captureImage=function(){var e=this;this.counter++;var t=this.getElementById("captureButton"),i=this.$element.find("video")[0],n=this.$element.find("canvas")[0];n.getContext("2d").drawImage(i,0,0,n.width,n.height);var s=this.createImageObject(n.toDataURL("image/jpeg"),this.counter);this.attachfilesClicked=!1,this.isMaxSelected()?(this.isWarning=!0,this.warningText=this.$translate.instant(this.resources.strings.select_media_warning_text_max_media_equal_to_one),this.maxAttachment>0&&(this.warningText=this.$translate.instant(this.resources.strings.select_media_warning_text_max_media_greater_than_one,{maxAttachment:this.maxAttachment+1})),this.ariaLiveService.update(this.warningText,!0),this.$timeout(function(){document.getElementById("close-warning").focus()})):(this.media=s,this.$timeout(function(){t.focus(),e.ariaLiveService.update(e.ariaOnCaptureImage,!0)}),this.addToScrollElement(s))},e.prototype.createImageObject=function(e,t){return this.setImageData(""+t,e.toString())},e.prototype.addToScrollElement=function(e){if(this.getElementByClass("ts-select-media-vdi").classList.remove("full-height"),this.isMaxSelected())return this.warningText=this.$translate.instant(this.resources.strings.select_media_warning_text_max_media_equal_to_one),this.maxAttachment>0&&(this.warningText=this.$translate.instant(this.resources.strings.select_media_warning_text_max_media_greater_than_one,{maxAttachment:this.maxAttachment+1})),this.isWarning=!0,void this.$timeout(function(){document.getElementById("close-warning").focus()});this.totalCaptures=this.mapImage.size+1,this.addToSelectAttach(e.id,e),this.isAttached=!1},e.prototype.updateScrollElementArray=function(e){this.scrollElements=e},e.prototype.focusScrollElementByClick=function(e){var t=this;this.previewIsRequested&&(this.previewIsRequested=!1),""!==this.attachPictures&&(this.attachPictures=""),e.stopPropagation();var i="IMG"===e.target.tagName&&e.target.parentElement||e.target;i!==this.currentScrollElement&&this.$timeout(function(){var e=t.getElementById("central-section");e.classList.add("central-section-image-viewer"),e.classList.remove("central-section");for(var n=i.firstElementChild,s=t.$element.find(".ts-thumbnail-scroll-item"),a=0;a<s.length;a++)i!==s[a]&&s[a].classList.add("ts-thumbnail-opacity");t.updateMainMedia(n.src,n),t.updateCurrentScrollElement(i),t.ariaLiveService.update(t.ariaOnImageSelected,!0)})},e.prototype.updateMainMedia=function(e,t){this.imageUrl=e},e.prototype.updateCurrentScrollElement=function(e){this.removeFocusElement(),this.currentScrollElement=e,this.enableRemoveButton(e),this.currentScrollElement.classList.add("ts-thumbnail-scroll-item-selected");var t=this.findIndexFromScrollElement(this.currentScrollElement.id);this.currentIndex=t+1,this.showPrevious=!(t<=0),this.showNext=!(t>=this.scrollElements.length-1),this.showMedia(e),this.showPlaceholderElement=!1},e.prototype.findIndexFromScrollElement=function(e){return this.scrollElements.findIndex(function(t){return t.id===e})},e.prototype.showMedia=function(e){if(this.currentScrollElement){var t=this.findIndexFromScrollElement(this.currentScrollElement.id);this.focusScrollElementByIndex(t,!1),this.currentReference=e.querySelector("img").src,this.updateMainMedia(this.currentReference,this.currentScrollElement.firstElementChild)}},e.prototype.previousMedia=function(e){var t=this;e.stopPropagation();var i=this.findIndexFromScrollElement(this.currentScrollElement.id);i>0&&(i--,this.updateCurrentScrollElement(this.getElementById(""+this.scrollElements[i].id)),this.$timeout(function(){t.currentReference=t.currentScrollElement&&t.currentScrollElement.firstElementChild&&t.currentScrollElement.firstChild.src,t.currentReference&&(t.updateMainMedia(t.currentReference,t.currentScrollElement.firstElementChild),t.focusScrollElementByIndex(i,!0)),t.showPrevious||t.getElementById("ts-select-next-media").focus()}))},e.prototype.nextMedia=function(e){var t=this;e.stopPropagation();var i=this.findIndexFromScrollElement(this.currentScrollElement.id);i<this.scrollElements.length-1&&(i++,this.updateCurrentScrollElement(this.getElementById(""+this.scrollElements[i].id)),this.$timeout(function(){t.currentReference=t.currentScrollElement&&t.currentScrollElement.firstElementChild&&t.currentScrollElement.firstChild.src,t.currentReference&&(t.updateMainMedia(t.currentReference,t.currentScrollElement.firstElementChild),t.focusScrollElementByIndex(i,!0)),t.showNext||t.getElementById("ts-select-previous-media").focus()}))},e.prototype.focusScrollElementByIndex=function(e,t){if(!t){var i=_.values(document.querySelectorAll(".ts-thumbnail-scroll-item"));i.forEach(function(t){e!==i.indexOf(t)&&t.classList.add("ts-thumbnail-opacity"),t.classList.remove("ts-thumbnail-smooth")}),i.forEach(function(e){e.classList.add("ts-thumbnail-smooth")})}this.ariaLiveService.update(this.ariaOnImageSelected,!0)},e.prototype.enableRemoveButton=function(e){e.querySelector("button").classList.remove("ng-hide")},e.prototype.removeFocusElement=function(){this.currentScrollElement&&(this.currentScrollElement.classList.remove("ts-thumbnail-scroll-item-selected"),this.currentScrollElement.querySelector("button").classList.add("ng-hide"),this.currentScrollElement=void 0)},e.prototype.isMaxSelected=function(){return this.maxAttachment<this.mapImage.size},e.prototype.showErrorDialog=function(e,t){this.dialogService.open(this.constants.dialogs.alert,{alertTitle:this.$translate.instant(e),alertMessage:this.$translate.instant(t)})},e.prototype.removeFromAttach=function(e){event.stopPropagation();var t=this.$translate.instant(this.resources.strings.select_media_remove_button_aria);if(this.ariaLiveService.update(t,!0),this.mapImage.has(e)&&(this.mapImage.delete(e),this.totalCaptures=this.mapImage.size),this.findIndexFromScrollElement(e)>-1){var i=this.findIndexFromScrollElement(e);1===this.scrollElements.length?(this.scrollElements.pop(),this.previewIsRequested=!0,this.showMediaContainer(),this.isAttached=!0,this.focusableElements[2].focus(),this.getElementByClass("ts-select-media-vdi").classList.add("full-height")):(this.getNextScrollElement(i),this.scrollElements.splice(i,1))}angular.isElement&&document.querySelector("#list-"+e).classList.add("ng-hide")},e.prototype.getNextScrollElement=function(e){var t=this,i=e;e>=this.scrollElements.length-1?(this.showPrevious=!1,e--):e++,e<0?this.previewIsRequested=!0:(this.openModal(this.getElementById("list-"+this.scrollElements[e].id)),this.updateCurrentScrollElement(this.getElementById(""+this.scrollElements[e].id)),this.currentIndex=i+1<=1||e<=1?1:e,0===i&&(this.showPrevious=!1),i>=this.scrollElements.length-1&&(this.showNext=!1,this.currentIndex=this.mapImage.size),this.$timeout(function(){t.currentReference=t.currentScrollElement&&t.currentScrollElement.firstElementChild&&t.currentScrollElement.firstChild.src,t.currentReference&&(t.updateMainMedia(t.currentReference,t.currentScrollElement.firstElementChild),t.focusScrollElementByIndex(e,!1))}))},e.prototype.lastScrollElement=function(){this.getElementByClass("ts-media-remove").classList.add("last-element")},e.prototype.addToSelectAttach=function(e,t){void 0!==t&&(this.mapImage.has(e)||this.mapImage.set(e,t.data),this.totalCaptures=this.mapImage.size)},e.prototype.showMediaContainer=function(){this.errorPlaceHolder=!0,this.previewIsRequested=!0,this.imageUrl="";for(var e=this.$element.find(".ts-thumbnail-scroll-item"),t=0;t<e.length;t++)e[t].classList.remove("ts-thumbnail-opacity");this.removeFocusElement(),this.errorPlaceHolder=!1;var i=this.getElementById("central-section");i.classList.add("central-section"),i.classList.remove("central-section-image-viewer"),this.attachPictures="Attach Pictures"},e.prototype.openModal=function(e){var t=document.querySelector(".ts-select-media");this.focusedElementBeforeModal=document.activeElement,t.addEventListener("keydown",function(e){"Tab"===e.code&&e.shiftKey&&document.activeElement===i&&(e.preventDefault(),n.focus())});this.focusableElements=t.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button, iframe, object, embed, [tabindex="0"], [contenteditable]'),this.focusableElements=Array.prototype.slice.call(this.focusableElements);var i=this.focusableElements[2],n=this.focusableElements[1];e?e.focus():i.focus()},e}();t.SelectMediaController=s,angular.module("teamspace.selectMedia",[]).component("selectMedia",{bindings:{mediaInputs:"@",attachCallback:"&"},controllerAs:"ctrl",controller:s,templateUrl:"components/select-media/select-media.html"}).run(["$templateCache",function(e){e.put("components/select-media/select-media.html",n)}])},2824:function(e,t){e.exports='<div class="ts-select-media vdi-occlusion" ng-show="ctrl.selectMediaPermissions" tabindex="0">\n  <input sanitized type="file" ng-model="ctrl.file" id="attachButton" accept="image/*" ng-click="ctrl.initializeGalleryMode()" multiple="true" ng-if="ctrl.onlyGalleryMode"/>\n  \x3c!--Banner--\x3e\n  <media-banner left-button="ctrl.camera" middle-text="ctrl.attachPictures" right-button="ctrl.attach" left-callback="ctrl.showMediaContainer()" right-callback="attach($event)" disable-right-button="ctrl.isAttached" show-left-button="!ctrl.previewIsRequested" show-right-button="true" close="ctrl.close(\'close dialog\')" class="ts-media-banner" role="menu" ng-if="!ctrl.onlyGalleryMode"></media-banner>\n  \x3c!-- Warning banner--\x3e\n  <media-warning-banner warning-text="ctrl.warningText" show="ctrl.isWarning" ng-if="!ctrl.onlyGalleryMode" class="ts-media-banner"/>\n  \x3c!--End Warning banner--\x3e\n  \x3c!--Video Container--\x3e\n  <div class="ts-select-media-vdi dark-background">\n    <div class="central-section" id="central-section">\n      <div class="ts-video-container select-media-main-video" id="video-container" ng-show="ctrl.previewIsRequested" ng-if="!ctrl.onlyGalleryMode">\n        <video-frame attach-button="ctrl.attachEnable" capture="ctrl.captureImage()" attach-callback="ctrl.previewFileAttachment(files)" permission-granted="ctrl.setPermission(permissionGranted)" callback-error="ctrl.getVideoErrors(callbackError)" camera-toggle="ctrl.toggleCamera"/>\n        <canvas id="canvas" style="display: none" autoplay width="1400" height="1080"></canvas>\n      </div>\n      \x3c!-- Main image --\x3e\n      <img ng-src="{{ctrl.imageUrl}}" role="img" class="ts-select-media-canvas-content" id="select-media-main-content" ng-if="!ctrl.previewIsRequested"/>\n    </div>\n  </div>\n  \x3c!-- Placeholder --\x3e\n  <div class="placeholder" ng-show="ctrl.previewIsRequested && !ctrl.isAttached" tabindex="-1">\n    {{ctrl.totalCaptures}} {{::$root.resources.strings.select_media_attach_pictures_index|translate}}\n  </div>\n  <div class="placeholder" ng-show="!ctrl.previewIsRequested" aria-hidden="true">\n    {{(ctrl.currentIndex) }} / {{ctrl.mapImage.size}} {{::$root.resources.strings.select_media_attach_pictures_index|translate}}\n  </div>\n  \x3c!-- End Placeholder --\x3e\n  \x3c!--Previous Arrow--\x3e\n  <div role="button" id="ts-select-media-previous-wrapper" ng-show="ctrl.showPrevious && !ctrl.previewIsRequested">\n    <button role="button" class="ts-sym ts-select-media-icon-button" id="ts-select-previous-media" aria-label="{{::$root.resources.strings.shortcut_previous_left_rail_item|translate}}" ng-click="ctrl.previousMedia($event)">\n      <ng-include src="\'svg/icons-chevron-left.html\'"></ng-include>\n    </button>\n  </div>\n  \x3c!--End Media Scroll Navigation--\x3e\n  \x3c!--Next Arrow--\x3e\n  <div role="button" id="ts-select-media-next-wrapper" ng-show="ctrl.showNext && !ctrl.previewIsRequested">\n    <button role="button" class="ts-sym ts-select-media-icon-button" id="ts-select-next-media" aria-label="{{::$root.resources.strings.shortcut_next_left_rail_item|translate}}" ng-click="ctrl.nextMedia($event)">\n      <ng-include src="\'svg/icons-chevron-right.html\'"></ng-include>\n    </button>\n  </div>\n  \x3c!--End Video Container--\x3e\n  <thumbnail-scroller class="ts-thumbnail-scroll" media="ctrl.media" media-array="ctrl.mediaArr" click-callback="ctrl.focusScrollElementByClick(event)" media-array-cb="ctrl.updateScrollElementArray(mediaArray)" desc-order="true" remove-button-cb="ctrl.removeFromAttach(item)" ng-if="!ctrl.onlyGalleryMode"/>\n</div>'},2825:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2826),s=function(){function e(e,t){this.desktopUtilityService=t,this.isVMWareEnv=!1,this.showPreview=!1,this.showPreview=e.ngDialogData.showPreview,this.isVMWareEnv=t.getVDIProvider()===teamspace.services.VdiProvider.vmware&&t.avIsRemoted()}return e.$inject=["$scope","desktopUtilityService"],e}();t.SelectMediaOverlay=s,angular.module("teamspace.selectMediaOverlay",[]).component("selectMediaOverlay",{bindings:{},controller:s,templateUrl:"components/select-media-overlay/select-media-overlay.html"}).run(["constants","dialogService","desktopUtilityService","$templateCache",function(e,t,i,a){a.put("components/select-media-overlay/select-media-overlay.html",n);var r="ts-modal-dialog custom-width select-media-overlay";i.getVDIProvider()===teamspace.services.VdiProvider.vmware&&i.avIsRemoted()&&(r+=" vmware-style"),t.register(e.lazyDialogs.selectMediaOverlay,{template:"components/select-media-overlay/select-media-overlay.html",className:r,showClose:!1,controller:s,controllerAs:"ctrl",ariaAuto:!1,ariaRole:"dialog",ariaLabelledById:"modalDialog-title",closeByNavigation:!0})}])},2826:function(e,t){e.exports='<div oc-lazy-load="media-api" class="ts-select-media-overlay vdi-donut-occlusion" ng-class="{\'vmware-style\': ctrl.isVMWareEnv, \'video-rendering\': ctrl.previewIsRendering }">\n  <select-media ng-if="!ctrl.showPreview" media-inputs="{{::ngDialogData.mediaInputs}}" attach-callback="ngDialogData.attachCallback(callback)"></select-media>\n  \x3c!-- Dialog shows the camera screen to select or Capture image from system. --\x3e\n  <image-viewer class="ts-image-viewer" ng-if="ctrl.showPreview" image-uris="ngDialogData.imageUris"></image-viewer>\n  \x3c!-- Dialog shows the images as per provided imageUris --\x3e\n</div>'},2827:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2828),s=function(){function e(e,t,i,n){this.$scope=e,this.constants=t,this.$element=i,this.loggingService=n,this.hasLeftButton=!1,this.hasRightButton=!1,this.hasMiddleText=!1,this.logger=n.newLogger("MediaAPIBannerCreated"),void 0==e.bn.leftButton&&""===e.bn.leftButton||(this.hasLeftButton=!0),void 0==e.bn.rightButton&&""===e.bn.rightButton||(this.hasRightButton=!0),void 0==e.bn.middleText&&""===e.bn.middleText||(this.hasMiddleText=!0),e.$watch("bn.disableRightButton",function(e,t){var n=e?"-1":"0";i.find("#rightButton")[0].setAttribute("tabIndex",n)}),e.$watch("bn.disableLeftButton",function(e,t){var n=e?"-1":"0";i.find("#leftButton")[0].setAttribute("tabIndex",n)})}return e.$inject=["$scope","constants","$element","loggingService"],e.prototype.leftButtonClicked=function(){this.$scope.bn.leftCallback({leftCallback:!0})},e.prototype.rightButtonClicked=function(){this.$scope.bn.rightCallback({rightCallback:!0})},e.prototype.closeAction=function(){this.logger.info("MediaAPIBanner created"),this.$scope.bn.close({close:!0})},e.prototype.onfocus=function(e){if(e.which===this.constants.keyCodes.tab){var t=this.$element.find("#banner-close-button")[0];e.target.addEventListener("transitionend",function(e){t.focus()})}},e}();t.MediaAPIBannerController=s,angular.module("teamspace.mediaAPIbanner",[]).component("mediaBanner",{bindings:{leftButton:"=?",disableLeftButton:"=?",showLeftButton:"=?",rightButton:"=?",disableRightButton:"=?",showRightButton:"=?",close:"&?",middleText:"=?",leftCallback:"&?",rightCallback:"&?"},templateUrl:"components/media-banner/media-head-banner.html",controller:s,controllerAs:"bn"}).run(["$templateCache",function(e){e.put("components/media-banner/media-head-banner.html",n)}])},2828:function(e,t){e.exports='\x3c!--Banner--\x3e\n<div class="ts-media-banner banner">\n  \x3c!--Back Button--\x3e\n  <button role="button" class="ts-btn ts-btn-fluent ts-btn-fluent-secondary-alternate ts-left-banner ng-scope" id="leftButton" aria-labelledby="{{::$root.resources.strings.media_banner_left_button_aria_label|translate}}" ng-click="bn.leftButtonClicked()" ng-show="bn.showLeftButton && bn.hasLeftButton" ng-disabled="bn.disableLeftButton">\n    <svg-include src="\'[[staticsPath]]/hashed/svg/media/icon-back-arrow-f094a17.html\'" class="banner-svg"></svg-include>\n    {{bn.leftButton}}\n  </button>\n  \x3c!--End Back Button--\x3e\n  \x3c!--Middle Text--\x3e\n  <h4 class="banner-text" ng-show="bn.hasMiddleText" aria-label="{{bn.middleText}}">{{bn.middleText}}</h4>\n  \x3c!--End Middle Text--\x3e\n  \x3c!--Banner Controls V1--\x3e\n  <div class="flex-container-centered">\n    \x3c!--Attach Controls--\x3e\n    <div class="flex-container-centered" ng-show="bn.hasRightButton">\n      \x3c!--Attach--\x3e\n      <button class="ts-btn ts-btn-fluent ts-btn-fluent-primary" id="rightButton" aria-label="{{::$root.resources.strings.media_banner_right_button_aria_label|translate}}" ng-click="bn.rightButtonClicked($event)" ng-show="bn.showRightButton" ng-disabled="bn.disableRightButton">\n        {{bn.rightButton}}\n      </button>\n      \x3c!--End Attach--\x3e\n    </div>\n    \x3c!--Close Media--\x3e\n    <button class="banner-close-button ts-btn ts-btn-fluent ts-btn-fluent-secondary-alternate" id="banner-close-button" aria-label="{{::$root.resources.strings.media_banner_close_button_aria_label|translate}}" ng-click="bn.closeAction(\'close dialog\')" translate-once="{{::$root.resources.strings.icons_close}}">\n      {{::$root.resources.strings.media_banner_close_button_aria_label|translate}}\n    </button>\n    \x3c!--End Close Media--\x3e\n  </div>\n</div>\n\x3c!--End Banner--\x3e'},2829:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2830),s=function(){function e(e,t){this.$scope=e,this.logger=t.newLogger("mediawarningBanner")}return e.$inject=["$scope","loggingService"],e.prototype.clickCloseWarning=function(){this.logger.info("closing media warning banner"),this.$scope.wb.show=!this.$scope.wb.show},e}();t.MediaWarningBannerController=s,angular.module("teamspace.mediaWarningBanner",[]).component("mediaWarningBanner",{bindings:{warningText:"=",show:"="},templateUrl:"components/media-banner/warning-banner.html",controller:s,controllerAs:"wb"}).run(["$templateCache",function(e){e.put("components/media-banner/warning-banner.html",n)}])},2830:function(e,t){e.exports='\x3c!-- Warning banner--\x3e\n<div class="ts-media-banner banner ts-warning-banner" ng-show="wb.show">\n  <div class="ts-left-banner ts-warning-title" id="media-warning" role="alert">\n    \x3c!--Warning text--\x3e\n    {{wb.warningText}}\n  </div>\n  \x3c!--End Warning text--\x3e\n  \x3c!-- close warning --\x3e\n  <div class="flex-container-centered">\n    <button class="ts-btn ts-btn-fluent ts-warning-close" role="button" id="close-warning" aria-label="{{::$root.resources.strings.media_banner_close_button_aria_label|translate}}" ng-click="wb.clickCloseWarning()">\n      <svg-include src="\'[[staticsPath]]/hashed/svg/media/icon-close-37105ed.html\'"></svg-include>\n    </button>\n    \x3c!-- close warning --\x3e\n  </div>\n</div>\n\x3c!--End Warning banner--\x3e'},2831:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2832),s=function(){function e(){this.cameras=[]}return e.prototype.enqueue=function(e){-1===this.cameras.indexOf(e)&&this.cameras.push(e)},e.prototype.dequeue=function(){return this.isEmpty()?"Underflow":this.cameras.shift()},e.prototype.front=function(){return this.isEmpty()?"No elements in Queue":this.cameras[0]},e.prototype.isEmpty=function(){return 0==this.cameras.length},e}();t.CameraQueue=s;var a=function(){function e(e,t,i,n,a,r,o,l,c,m,d){var h=this;this.constants=e,this.$scope=t,this.$timeout=i,this.ariaLiveService=n,this.$translate=a,this.resources=r,this.adminSettingsService=o,this.settingsService=l,this.loggingService=c,this.$element=m,this.deviceManagerService=d,this.showVideo=!1,this.cameraDeviceIdMap=new Map,this.logger=c.newLogger("videoFrame"),this.cameras=new s,this.isVideoEnabled=o.getAdminSettingSync().isVideoEnabled,this.isDesktop=l.valueAsBoolean(e.settings.names.isDesktopApp),this.hasVideoInput=this.isVideoEnabled,this.deviceManagerChangedSubscription=d.safeSubscribe(t,function(){h.getVideoDevices()},e.events.calling.devicesChanged),d.whenInitialized(this.isDesktop).then(function(){return h.getVideoDevices()}),t.$watch("ctrl.cameraId",function(e,i){e!==i&&(t.ctrl.cameraId?(h.selectedCamera=t.ctrl.cameraId,h.startVideo()):h.getVideoDevices())}),t.$on("$destroy",function(){h.showVideo=!1,d.unsubscribe(h.deviceManagerChangedSubscription),h.stopStreamedVideo(h.previewStream)})}return e.$inject=["constants","$scope","$timeout","ariaLiveService","$translate","resources","adminSettingsService","settingsService","loggingService","$element","deviceManagerService"],e.prototype.onKeyPress=function(e){e.which===this.constants.keyCodes.enter&&this.attachFile(e)},e.prototype.getVideoDevices=function(){var e=this;this.$scope.ctrl.cameraId?(this.selectedCamera=this.$scope.ctrl.cameraId.replace("camera:",""),this.logger.info("cameras: "+JSON.stringify(this.selectedCamera))):navigator.mediaDevices.getUserMedia({audio:!1,video:!0}).then(function(t){e.previewStream=t,e.handleStream(t),navigator.mediaDevices.enumerateDevices().then(function(t){if(t.forEach(function(t){"videoinput"===t.kind&&""!=t.deviceId&&(e.cameras.enqueue(t),e.cameraDeviceIdMap.set(t.deviceId,t))}),e.cameras.isEmpty()){var i={name:"NoHardwareSupport"};e.reportVideoError(i)}e.selectedCamera=e.cameras.front().deviceId,e.selectedCamera&&e.permissionGranted({permissionGranted:!0}),e.canToggleCamera=e.isVideoEnabled&&e.cameras.cameras.length>1&&e.$scope.ctrl.cameraToggle})}).catch(function(t){e.showVideo=!1,e.previewStream&&e.stopStreamedVideo(e.previewStream),e.permissionGranted({permissionGranted:!1});var i={name:t.name};e.reportVideoError(i)}),this.selectedCamera&&(this.permissionGranted({permissionGranted:!0}),this.startVideo())},e.prototype.startVideo=function(){var e=this;this.previewStream&&this.stopStreamedVideo(this.previewStream),navigator.mediaDevices.getUserMedia({audio:!1,video:{deviceId:this.selectedCamera}}).then(function(t){console.log("Video Stream : "+t),e.handleStream(t)}).catch(function(t){e.hasVideoInput=!1,t&&e.reportVideoError(t)})},e.prototype.handleStream=function(e){var t=this;this.$element.find("#select-media-main-video")[0].srcObject=e,this.previewStream=e,this.showVideo=!0,this.$timeout(function(){t.$element.find("#cameraToggle")[0].focus()})},e.prototype.stopStreamedVideo=function(e){var t=this.$element.find("#select-media-main-video")[0];if(e){var i=e.getTracks();this.showVideo=!1,i.forEach(function(t){t.stop(),e.removeTrack(t)})}this.previewStream=null,t&&(t.srcObject=null)},e.prototype.reportVideoError=function(e){switch(e.name){case"NotAllowedError":this.throwError(teamspace.services.microsoftTeamsInternal.sdkErrorMessages.PERMISSION_DENIED,teamspace.services.microsoftTeamsInternal.sdkErrorCodes.PERMISSION_DENIED);break;case"NotReadableError":this.throwError(teamspace.services.microsoftTeamsInternal.sdkErrorMessages.CAMERA_IN_USE,teamspace.services.microsoftTeamsInternal.sdkErrorCodes.INTERNAL_ERROR);break;case"NoHandwareSupport":this.throwError(teamspace.services.microsoftTeamsInternal.sdkErrorMessages.NO_HW_SUPPORT,teamspace.services.microsoftTeamsInternal.sdkErrorCodes.NO_HW_SUPPORT);break;default:this.throwError(e.name,teamspace.services.microsoftTeamsInternal.sdkErrorCodes.INTERNAL_ERROR)}this.hasVideoInput=!1},e.prototype.throwError=function(e,t){var i={errorCode:t,message:e};this.callbackError({callbackError:i})},e.prototype.toggleCamera=function(){this.canToggleCamera=!0;var e=this.cameraDeviceIdMap.get(this.selectedCamera);this.cameras.dequeue();var t=this.cameras.front();this.selectedCamera=t.deviceId,this.$scope.ctrl.cameraId=this.selectedCamera,this.cameras.enqueue(e);var i=this.$translate.instant(this.resources.strings.select_media_video_frame_camera_toggle_aria,{cameraLabel:t.label});this.ariaLiveService.update(i,!0)},e.prototype.attachFile=function(e){e&&this.$scope.ctrl.attachCallback({files:e})},e}();t.VideoFrameController=a,angular.module("teamspace.videoFrame",[]).component("videoFrame",{bindings:{cameraId:"=?",attachButton:"=?",attachCallback:"&?",capture:"&?",permissionGranted:"&",callbackError:"&?",cameraToggle:"=?"},controllerAs:"ctrl",controller:a,templateUrl:"components/select-media/video-frame.html"}).run(["$templateCache",function(e){e.put("components/select-media/video-frame.html",n)}])},2832:function(e,t){e.exports='<div class="ts-video-frame" ng-show="ctrl.showVideo">\n  \x3c!-- Grid lines--\x3e\n  <div id="grid" aria-hidden="true">\n    <hr class="horizontal1" id="horizontal1">\n    <hr class="horizontal2" id="horizontal2">\n    <hr class="vertical1" id="vertical1">\n    <hr class="vertical2" id="vertical2">\n  </div>\n  \x3c!-- End Grid lines--\x3e\n  <video class="ng-scope" playsinline autoplay id="select-media-main-video"></video>\n  <div class="controls controls-banner">\n    \x3c!-- Attach from gallery --\x3e\n    <button title="Attach" id="attachButton" aria-label="{{::$root.resources.strings.select_media_video_frame_file_attach|translate}}" class="ts-sym ts-btn-fluent sidebtnleft app-icons-fill-focus inset-border inset-border-round inset-border-themed pointer-cursor ng-scope" autofocus="true" ng-show="{{ctrl.attachButton}}" accept="image/*" ng-model="ctrl.file" ngf-select="ctrl.attachFile($files)" ngf-multiple="true">\n      <div class="bottom-video-control-margin">\n        <label for="file-input">\n          <svg-include src="\'[[staticsPath]]/hashed/svg/media/icon-file-input-12f64a1.html\'"></svg-include>\n        </label>\n      </div>\n    </button>\n    <span ng-if="!ctrl.attachButton && ctrl.canToggleCamera" class="empty-span-left"></span>\n    \x3c!-- End Attach from gallery --\x3e\n    \x3c!-- Camera Button --\x3e\n    <button type="button" role="button" id="captureButton" title="Camera" aria-label="{{::$root.resources.strings.select_media_video_frame_camera|translate}}" class="ts-sym centre-btn ts-btn-fluent app-icons-fill-focus inset-border inset-border-round inset-border-themed ng-scope" autofocus="true" ng-click="ctrl.capture()">\n      <svg-include src="\'[[staticsPath]]/hashed/svg/media/icon-camera-button-2ef500f.html\'"></svg-include>\n    </button>\n    \x3c!-- End Camera Button --\x3e\n    <span ng-if="!ctrl.canToggleCamera && ctrl.attachButton" class="empty-span-left"></span>\n    \x3c!-- Camera toggle Button --\x3e\n    <button type="button" role="button" id="cameraToggle" title="Camera toggle" aria-label="{{::$root.resources.strings.select_media_video_frame_camera_toggle|translate}}" ng-show="ctrl.canToggleCamera" class="ts-sym sidebtnright ts-btn-fluent app-icons-fill-focus inset-border inset-border-round inset-border-themed ng-scope" autofocus="true" ng-click="ctrl.toggleCamera()">\n      <svg-include src="\'[[staticsPath]]/hashed/svg/media/icon-camera-toggle-c161bff.html\'"></svg-include>\n    </button>\n    \x3c!-- End Camera toggle Button --\x3e\n  </div>\n</div>'},2833:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2834),s=function(){function e(e,t,i,n){var s=this;this.$scope=e,this.$timeout=t,this.loggingService=i,this.$element=n,this.logger=i.newLogger("Thumbnail scroller created"),this.scrollElements=[],e.$watch("tsCtrl.media",function(e,t){e!==t&&null!==e&&s.startMediaScroller(e)}),e.$watchCollection("tsCtrl.mediaArray",function(e,t){null===e||_.isEmpty(e)||s.startMediaScroller(e)})}return e.$inject=["$scope","$timeout","loggingService","$element"],e.prototype.startMediaScroller=function(e){var t=this;Array.isArray(e)&&e.length>0?e.forEach(function(e){t.scrollElements.some(function(t){return t.id===e.id})||t.addScrollElement(e)}):this.addScrollElement(e),this.$scope.tsCtrl.viewOnly&&this.viewOnlyThumbnails()},e.prototype.addScrollElement=function(e){this.scrollElements.reverse(),this.scrollElements.push(e),this.scrollElements.reverse(),this.$scope.tsCtrl.mediaArrayCb({mediaArray:this.scrollElements})},e.prototype.viewOnlyThumbnails=function(){var e=this;this.$timeout(function(){for(var t=e.$element.find("li"),i=0;i<t.length;i++)t[i].classList.add("ts-thumbnail-opacity");var n=e.$element.find("li")[0];n&&n.classList.add("ts-thumbnail-scroll-item-selected")})},e}();t.ThumbnailScrollerController=s,angular.module("teamspace.thumbnailScroller",[]).component("thumbnailScroller",{bindings:{media:"=?",mediaArray:"=?",clickCallback:"&?",mediaArrayCb:"&?",removeButtonCb:"&?",viewOnly:"=?"},templateUrl:"components/thumbnail-scroller/thumbnail-scroller.html",controller:s,controllerAs:"tsCtrl"}).run(["$templateCache",function(e){e.put("components/thumbnail-scroller/thumbnail-scroller.html",n)}])},2834:function(e,t){e.exports='\x3c!--Media Scroll Navigation--\x3e\n<div id="ts-thumbnail-scroll-navigation" class="ts-thumbnail-scroll single-line-truncation scroller-background">\n  \x3c!--Media Scrollbar, menu role used for screen reader to announce # of list items--\x3e\n  <ul id="ts-thumbnail-scroll" acc-role="list" role="list" aria-label="{{::$root.resources.strings.select_media_on_image_list_aria_label|translate}}">\n    <li ng-repeat="scrollElem in tsCtrl.scrollElements" class="ts-thumbnail-scroll-item ts-thumbnail-smooth" ng-click="tsCtrl.clickCallback({ event: $event })" id="{{::scrollElem.id}}" role="listitem" aria-label="{{::$root.resources.strings.select_media_on_image_list_aria_label|translate}}">\n      <img role="button" id="list-{{::scrollElem.id}}" ng-src="{{::scrollElem.data}}" tabindex="0" aria-label="{{::$root.resources.strings.select_media_image_aria_label|translate}}" onkeypress="tsCtrl.onKeyPress($event)" class="ts-thumbnail-scroll-image ts-btn-fluent-primary"/>\n      <button class="ts-btn ts-btn-fluent ts-media-remove ng-hide" role="button" type="button" aria-label="{{::$root.resources.strings.select_media_remove_button|translate}}" ng-click="tsCtrl.removeButtonCb({ item: scrollElem.id })">\n        <svg-include src="\'[[staticsPath]]/hashed/svg/media/icon-remove-button-06314d4.html\'"></svg-include>\n      </button>\n    </li>\n  </ul>\n</div>\n\x3c!--End Media Scrollbar--\x3e'},2835:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2836),s="ts-image-viewer-zoom-button-disabled",a=function(){function e(e,t,i,n,s,a,r,o,l,c){var m=this;if(this.constants=e,this.loggingService=t,this.$element=i,this.$scope=n,this.utilityService=s,this.ariaLiveService=a,this.resources=r,this.$translate=o,this.ngDialog=l,this.$timeout=c,this.mediaArr=[],this.imagesArray=[],this.showScroller=!1,this.heightLowerLimit=100,this.zoomScale=1.2,this.zoomLimit=2,this.canZoomIn=!0,this.canZoomOut=!0,this.resetDisable=!0,this.imageUrl=null,this.logger=t.newLogger("Image viewer scroller created"),this.zoomInCompleteMsg=o.instant(r.strings.files_mediaPreview_OnZoomInComplete),this.zoomOutCompleteMsg=o.instant(r.strings.files_mediaPreview_OnZoomOutComplete),this.zoomResetCompleteMsg=o.instant(r.strings.files_mediaPreview_OnZoomResetComplete),this.ariaOnImageSelected=o.instant(r.strings.select_media_on_image_selection_aria_label),this.scrollElements=[],this.mediaArr=[],this.imageUrl=n.$ctrl.imageUris[0],this.initializeZoom(),n.$ctrl.imageUris.length>1){this.showScroller=!0,this.showPrevious=!1,this.showNext=!0;var d=0;this.mediaUris=n.$ctrl.imageUris.map(function(e){return m.setImageData(""+d++,e)}),this.mediaArr=this.mediaUris.reverse()}else i.find(".ts-image-viewer-canvas")&&i.find(".ts-image-container")&&(i.find(".ts-image-viewer-canvas")[0].classList.add("ts-image-viewer-canvas-single-image"),i.find(".ts-image-container")[0].classList.add("ts-single-image-container"))}return e.$inject=["constants","loggingService","$element","$scope","utilityService","ariaLiveService","resources","$translate","ngDialog","$timeout"],e.prototype.setImageData=function(e,t){return{id:e,data:t}},e.prototype.initializeZoom=function(){this.resetTitle=this.$translate.instant(this.resources.strings.files_mediaPreviewReset),this.zoomInTitle=this.$translate.instant(this.resources.strings.files_mediaPreviewZoomIn),this.zoomOutTitle=this.$translate.instant(this.resources.strings.files_mediaPreviewZoomOut),this.clicking=!1,this.zoomSetup=!1,this.isZoomed=!1,this.resetDisable=!0,this.$element.find("#ts-image-viewer-reset")&&this.$element.find("#ts-image-viewer-reset")[0].classList.add(s)},e.prototype.showInTab=function(e){e.stopPropagation(),this.isZoomingEnabled?this.enterZoom(!1,!1):this.$scope.isDesktopWin||this.$scope.isDesktopMac||window.open(this.imageUrl)},e.prototype.updateScrollElementArray=function(e){this.scrollElements=e,this.mediaArr.length===this.scrollElements.length&&(this.focusScrollElementByIndex(0),this.updateCurrentScrollElement(this.$element.find("#"+this.scrollElements[0].id)[0]))},e.prototype.getImageNaturalDimensions=function(e){this.imageForSize=new Image,this.imageForSize.src=e,this.naturalHeight=this.imageForSize.naturalHeight,this.naturalWidth=this.imageForSize.naturalWidth},e.prototype.setZoomingStates=function(){this.naturalHeight=0,this.naturalWidth=0,this.panCanvasHeight=0,this.panCanvasWidth=0,this.getImageNaturalDimensions(this.imageUrl),$(window).on("resize",{controller:this},this.resizeCallback)},e.prototype.resizeCallback=function(e){e.data.controller.$scope.isZoomed&&e.data.controller.getCanvasDimensions()},e.prototype.close=function(e){this.$scope.$emit(this.constants.events.mediaApiEvents.imageViewerClosePressed,null),this.logger.info("Image-viewer stopped: "+e),this.closeDialog()},e.prototype.focusScrollElementByClick=function(e){var t=this;e.stopPropagation(),this.hideZoom(e);var i="IMG"===e.target.tagName&&e.target.parentElement||e.target;i!==this.currentScrollElement&&this.$timeout(function(){var e=i.firstElementChild;t.imageUrl=e.src;for(var n=t.$element.find(".ts-thumbnail-scroll-item"),s=0;s<n.length;s++)i!==n[s]&&n[s].classList.add("ts-thumbnail-opacity");t.setZoomingStates(),t.updateMainMedia(e.src,e),t.updateCurrentScrollElement(i),t.ariaLiveService.update(t.ariaOnImageSelected,!0)})},e.prototype.removeFocusElement=function(){this.currentScrollElement&&(this.currentScrollElement.classList.remove("ts-thumbnail-scroll-item-selected"),this.currentScrollElement=void 0)},e.prototype.updateCurrentScrollElement=function(e){if(this.currentScrollElement){this.removeFocusElement(),this.currentScrollElement=e,this.currentScrollElement.classList.add("ts-thumbnail-scroll-item-selected");var t=this.findIndexFromScrollElement(this.currentScrollElement.id);this.showPrevious=!(t<=0),this.showNext=!(t>=this.scrollElements.length-1),this.showMedia(e)}},e.prototype.showMedia=function(e){this.currentScrollElement&&(this.focusScrollElementByIndex(this.scrollElements.indexOf(this.currentScrollElement)),this.currentReference=e.querySelector("img").src,this.imageUrl=this.currentReference,this.setZoomingStates(),this.updateMainMedia(this.currentReference,this.currentScrollElement.firstElementChild))},e.prototype.previousMedia=function(e){var t=this;e.stopPropagation(),this.hideZoom(e);var i=this.findIndexFromScrollElement(this.currentScrollElement.id);i>0&&(i--,this.updateCurrentScrollElement(this.$element.find("#"+this.scrollElements[i].id)[0]),this.$timeout(function(){t.currentReference=t.currentScrollElement&&t.currentScrollElement.firstElementChild&&t.currentScrollElement.firstChild.src,t.currentReference&&(t.updateMainMedia(t.currentReference,t.currentScrollElement.firstElementChild),t.focusScrollElementByIndex(i),t.hideZoom(e)),t.showPrevious||t.$element.find("#ts-select-next-media").focus()}))},e.prototype.findIndexFromScrollElement=function(e){return this.scrollElements.findIndex(function(t){return t.id===e})},e.prototype.nextMedia=function(e){var t=this;e.stopPropagation(),this.hideZoom(e),this.currentScrollElement||(this.currentScrollElement=this.$element.find("#"+this.scrollElements[0].id)[0]);var i=this.findIndexFromScrollElement(this.currentScrollElement.id);i<this.scrollElements.length-1&&(i++,this.updateCurrentScrollElement(this.$element.find("#"+this.scrollElements[i].id)[0]),this.$timeout(function(){t.currentReference=t.currentScrollElement&&t.currentScrollElement.firstElementChild&&t.currentScrollElement.firstChild.src,t.currentReference&&(t.updateMainMedia(t.currentReference,t.currentScrollElement.firstElementChild),t.focusScrollElementByIndex(i),t.hideZoom(e)),t.showNext||t.$element.find("#ts-select-previous-media").focus()}))},e.prototype.focusScrollElementByIndex=function(e){var t=_.values(document.querySelectorAll(".ts-thumbnail-scroll-item"));t.forEach(function(i){e!==t.indexOf(i)&&i.classList.add("ts-thumbnail-opacity"),i.classList.remove("ts-thumbnail-smooth")}),t.forEach(function(e){e.classList.add("ts-thumbnail-smooth")})},e.prototype.updateMainMedia=function(e,t){this.naturalHeight=t.naturalHeight,this.naturalWidth=t.naturalWidth,this.widthUpperLimit=t.naturalWidth*this.zoomLimit,this.imageUrl=e},e.prototype.rightClickHandler=function(e){this.utilityService.stopEvent(e)},e.prototype.zoomInFromUnzoomedState=function(){var e=$("#image-viewer-main-content"),t=e.height(),i=e.width();this.enterZoom(!0,!1),e.addClass("ts-image-viewer-canvas-zoom"),e.width(i*this.zoomScale).height(t*this.zoomScale)},e.prototype.zoomOutFromUnzoomedState=function(){var e=$("#image-viewer-main-content"),t=e.height(),i=e.width();this.enterZoom(!1,!0),e.addClass("ts-image-viewer-canvas-zoom"),e.width(i/this.zoomScale).height(t/this.zoomScale)},e.prototype.getCanvasDimensions=function(){var e=$(document);this.panCanvasHeight=e.height(),this.panCanvasWidth=e.width()},e.prototype.zoomIn=function(e){if(this.resetDisable){this.resetDisable=!1,$("#ts-image-viewer-reset").removeClass(s);var t=$("#image-viewer-main-content");this.naturalHeight=t.height(),this.naturalWidth=t.width()}if(this.getCanvasDimensions(),e.stopPropagation(),!this.canZoomOut){this.canZoomOut=!0;var i=$("#ts-image-viewer-zoom-out");i.removeClass(s),i.attr("tabindex",0)}var n=$("#image-viewer-main-content");if(!this.isZoomed)return this.zoomInFromUnzoomedState(),void this.ariaLiveService.update(this.zoomInCompleteMsg,!0);var a=n.height(),r=n.width()*this.zoomScale,o=a*this.zoomScale;if(this.widthUpperLimit||(this.widthUpperLimit=n.naturalWidth*this.zoomLimit),r>=this.widthUpperLimit){if(this.canZoomIn){this.canZoomIn=!1;var l=$("#ts-image-viewer-zoom-in");l.addClass(s),l.attr("tabindex",-1),document.querySelector("#ts-image-viewer-zoom-out").focus()}}else o>=this.panCanvasHeight&&(n.css({position:"relative"}),n.width(r)),n.width(r).height(o),this.scrollElements&&this.scrollElements.length>1&&(this.showScroller=n.height()<=.7*window.outerHeight,this.currentScrollElement&&(this.currentScrollElement=this.$element.find("#0")[0])),this.ariaLiveService.update(this.zoomInCompleteMsg,!0)},e.prototype.zoomOut=function(e){if(this.resetDisable){this.resetDisable=!1,$("#ts-image-viewer-reset").removeClass(s);var t=$("#image-viewer-main-content");this.naturalHeight=t.height(),this.naturalWidth=t.width()}if(this.getCanvasDimensions(),e.stopPropagation(),!this.canZoomIn){this.canZoomIn=!0;var i=$("#ts-image-viewer-zoom-in");i.removeClass(s),i.attr("tabindex",0)}if(!this.isZoomed)return this.zoomOutFromUnzoomedState(),void this.ariaLiveService.update(this.zoomOutCompleteMsg,!0);var n=$("#image-viewer-main-content"),a=n.height(),r=n.width()/this.zoomScale,o=a/this.zoomScale;if(o<this.heightLowerLimit){if(this.canZoomOut){this.canZoomOut=!1;var l=$("#ts-image-viewer-zoom-out");l.addClass(s),l.attr("tabindex",-1),document.querySelector("#ts-image-viewer-zoom-in").focus()}}else n.width(r).height(o),this.scrollElements&&this.scrollElements.length>1&&(this.showScroller=n.height()<=.7*$(window).height()),this.ariaLiveService.update(this.zoomOutCompleteMsg,!0)},e.prototype.enterZoom=function(e,t){var i=this,n=$(".ts-image-viewer-canvas"),s=n.height(),a=$("#image-viewer-main-content"),r=a.height();this.heightLowerLimit=r/2,this.isZoomed=!0;var o=a;if(e&&!t?r*this.zoomScale>=s&&o.css({position:"relative"}):!e&&t?o.css({position:"relative"}):e||t?o.css({position:"relative"}):this.naturalHeight>=s&&o.css({position:"relative"}),!this.zoomSetup){var l=n;o.mousedown(function(e){i.clickedOnZoomImage=!0}),o.on("wheel",function(e){e.preventDefault(),e.originalEvent.deltaY>0?i.zoomIn(e):i.zoomOut(e)}),l.mousedown(function(e){e.preventDefault(),i.previousX=e.clientX,i.previousY=e.clientY,i.clicking=!0,o.addClass("ts-image-viewer-grabbing")}),l.mouseup(function(){o.removeClass("ts-image-viewer-grabbing"),i.clicking=!1}),l.mousemove(function(e){i.clicking&&(e.preventDefault(),e.stopPropagation(),l.scrollLeft(l.scrollLeft()+(i.previousX-e.clientX)),l.scrollTop(l.scrollTop()+(i.previousY-e.clientY)),i.previousX=e.clientX,i.previousY=e.clientY)}),l.mouseleave(function(e){o.removeClass("ts-image-viewer-grabbing"),i.clicking=!1}),this.zoomSetup=!0}},e.prototype.hideZoom=function(e){if(e&&e.stopPropagation(),this.isZoomed){this.isZoomed=!1,this.canZoomIn=!0,this.canZoomOut=!0,this.resetDisable=!0,$("#ts-image-viewer-reset").addClass(s);var t=$("#image-viewer-main-content"),i=$("#ts-image-viewer-zoom-in"),n=$("#ts-image-viewer-zoom-out"),a=this.naturalWidth/this.naturalHeight;e?t.width(this.naturalWidth):t.width("").height(""),t.removeClass("ts-image-viewer-canvas-zoom"),e&&t.height(t.width()/a),i.attr("tabindex",0),n.attr("tabindex",0),this.showScroller=this.scrollElements&&this.scrollElements.length>1,i.removeClass(s),n.removeClass(s),e&&this.ariaLiveService.update(this.zoomResetCompleteMsg,!0)}},e.prototype.closeDialog=function(){this.ngDialog.closeAll()},e}();t.ImageViewerController=a,angular.module("teamspace.imageViewer",[]).component("imageViewer",{bindings:{imageUris:"<"},templateUrl:"components/select-media-image-viewer/image-viewer.html",controller:a,controllerAs:"$ctrl"}).run(["$templateCache",function(e){e.put("components/select-media-image-viewer/image-viewer.html",n)}])},2836:function(e,t){e.exports='<div class="ts-image-viewer dark-background" acc-role="dialog" data-tid="imageViewer">\n\n  \x3c!--Banner--\x3e\n  <div class="banner">\n    \x3c!--Image Viewer left section--\x3e\n    <div class="ts-image-viewer-left-banner"></div>\n    \x3c!--End Image Viewer left section--\x3e\n\n    \x3c!--Banner--\x3e\n    <div class="flex-container-centered">\n      \x3c!--Zoom Controls--\x3e\n      <div class="flex-container-centered zoom-enabled-buttons ts-button-group-margin">\n        \x3c!--Reset Zoom--\x3e\n        <button class="ts-image-viewer-icon-button ts-btn" ng-attr-title="{{::$ctrl.resetTitle}}" ng-click="$ctrl.hideZoom($event)" id="ts-image-viewer-reset" ng-disabled="$ctrl.resetDisable" aria-label="{{::$root.resources.strings.image_viewer_aria_label_reset_zoom|translate}}">\n          <ng-include src="\'svg/icons-expand-to-fullscreen.html\'"></ng-include>\n        </button>\n        \x3c!--End Reset Zoom--\x3e\n        \x3c!--Zoom Out--\x3e\n        <button class="ts-image-viewer-icon-button ts-btn" ng-attr-title="{{::$ctrl.zoomOutTitle}}" id="ts-image-viewer-zoom-out" ng-click="$ctrl.zoomOut($event)" aria-label="{{::$root.resources.strings.image_viewer_aria_label_zoom_out|translate}}" ng-disabled="!$ctrl.canZoomOut">\n          <ng-include src="\'svg/icons-zoom-out.html\'"></ng-include>\n        </button>\n        \x3c!--End Zoom Out--\x3e\n        \x3c!--Zoom In--\x3e\n        <button class="ts-image-viewer-icon-button ts-btn" ng-attr-title="{{::$ctrl.zoomInTitle}}" id="ts-image-viewer-zoom-in" ng-click="$ctrl.zoomIn($event)" ng-disabled="!$ctrl.canZoomIn" aria-label="{{::$root.resources.strings.image_viewer_aria_label_zoom_in|translate}}">\n          <ng-include src="\'svg/icons-zoom-in.html\'"></ng-include>\n        </button>\n        \x3c!--End Zoom In--\x3e\n      </div>\n      \x3c!--End Zoom Controls--\x3e\n      \x3c!--Close Preview--\x3e\n      <button class="ts-btn ts-btn-fluent ts-btn-fluent-secondary-alternate" id="ts-image-viewer-close-button" ng-click="$ctrl.close(\'close dialog\')" translate-once="{{::$root.resources.strings.icons_close}}" aria-label="Close. {{::$root.resources.strings.media_banner_close_button_aria_label|translate}}" role="button"></button>\n      \x3c!--End Close Preview--\x3e\n    </div>\n    \x3c!--End Banner --\x3e\n  </div>\n  \x3c!--End Banner--\x3e\n  \x3c!--Media Preview Canvas--\x3e\n  <div class="ts-image-viewer-canvas">\n    \x3c!--Media Navigation--\x3e\n    <div id="ts-image-viewer-preview-navigation">\n      \x3c!--Previous Arrow--\x3e\n      <div id="ts-image-viewer-previous-wrapper" ng-show="$ctrl.showPrevious">\n        <button class="ts-image-viewer-icon-button ts-sym ts-btn ts-btn-fluent" tabindex="1" id="ts-select-previous-media" role="button" ng-click="$ctrl.previousMedia($event)" aria-label="{{::$root.resources.strings.shortcut_previous_left_rail_item|translate}}">\n          <ng-include src="\'svg/icons-chevron-left.html\'"></ng-include>\n        </button>\n      </div>\n      \x3c!--Previewed Media--\x3e\n      <div class="ts-image-container" ts-right-click="$ctrl.rightClickHandler($event)">\n        <img ng-src="{{$ctrl.imageUrl}}" tabindex="1" role="img" class="ts-image-viewer-canvas-content" style="position: relative;" id="image-viewer-main-content" ng-class="::{\'ts-select-media-canvas-content-desktop\' : !isWeb, \'ts-image-viewer-canvas-content-zoom\' : $ctrl.isZoomingEnabled}" ng-click="$ctrl.showInTab($event)"/>\n      </div>\n      \x3c!--Next Arrow--\x3e\n      <div id="ts-image-viewer-next-wrapper" ng-show="$ctrl.showNext">\n        <button class="ts-image-viewer-icon-button ts-sym ts-btn ts-btn-fluent" tabindex="1" id="ts-select-next-media" ng-click="$ctrl.nextMedia($event)" aria-label="{{::$root.resources.strings.shortcut_next_left_rail_item|translate}}">\n          <ng-include src="\'svg/icons-chevron-right.html\'"></ng-include>\n        </button>\n      </div>\n    </div>\n  </div>\n  \x3c!--End Media Preview Canvas--\x3e\n\n  \x3c!--Media Scroll Navigation--\x3e\n  <thumbnail-scroller class="ts-thumbnail-scroll" ng-if="$ctrl.showScroller" media-array="$ctrl.mediaArr" click-callback="$ctrl.focusScrollElementByClick(event)" media-array-cb="$ctrl.updateScrollElementArray(mediaArray)" view-only="true" tabindex="0" aria-roledescription="{{::$root.resources.strings.select_media_thumbnail_scroller_aria_label|translate}}" aria-labelledby="{{::$root.resources.strings.select_media_thumbnail_scroller_aria_label|translate}}">\n  </thumbnail-scroller>\n  \x3c!--End Media Navigation--\x3e\n</div>'}},[2822]);